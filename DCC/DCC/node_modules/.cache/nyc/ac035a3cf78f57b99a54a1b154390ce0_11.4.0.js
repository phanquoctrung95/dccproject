var cov_2qfzt7e73w=function(){var path='D:\\DCC\\dcc\\server\\routes\\user\\userProfile.js',hash='8260335525faa4d81629398c277ea6fad36c5254',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'D:\\DCC\\dcc\\server\\routes\\user\\userProfile.js',statementMap:{'0':{start:{line:1,column:13},end:{line:1,column:40}},'1':{start:{line:2,column:13},end:{line:2,column:36}},'2':{start:{line:3,column:10},end:{line:3,column:47}},'3':{start:{line:4,column:10},end:{line:4,column:24}},'4':{start:{line:5,column:11},end:{line:5,column:24}},'5':{start:{line:6,column:16},end:{line:6,column:51}},'6':{start:{line:7,column:11},end:{line:7,column:37}},'7':{start:{line:8,column:14},end:{line:8,column:51}},'8':{start:{line:10,column:13},end:{line:10,column:30}},'9':{start:{line:11,column:14},end:{line:18,column:2}},'10':{start:{line:13,column:8},end:{line:13,column:48}},'11':{start:{line:16,column:8},end:{line:16,column:78}},'12':{start:{line:22,column:13},end:{line:24,column:8}},'13':{start:{line:27,column:0},end:{line:29,column:3}},'14':{start:{line:31,column:0},end:{line:39,column:3}},'15':{start:{line:32,column:4},end:{line:38,column:6}},'16':{start:{line:33,column:8},end:{line:37,column:10}},'17':{start:{line:40,column:0},end:{line:48,column:3}},'18':{start:{line:41,column:4},end:{line:47,column:6}},'19':{start:{line:42,column:8},end:{line:46,column:10}},'20':{start:{line:50,column:0},end:{line:84,column:3}},'21':{start:{line:51,column:4},end:{line:83,column:5}},'22':{start:{line:52,column:8},end:{line:80,column:11}},'23':{start:{line:53,column:30},end:{line:55,column:58}},'24':{start:{line:56,column:12},end:{line:79,column:15}},'25':{start:{line:82,column:8},end:{line:82,column:68}},'26':{start:{line:87,column:0},end:{line:114,column:3}},'27':{start:{line:88,column:4},end:{line:113,column:7}},'28':{start:{line:108,column:8},end:{line:108,column:54}},'29':{start:{line:109,column:8},end:{line:112,column:11}},'30':{start:{line:116,column:0},end:{line:131,column:3}},'31':{start:{line:117,column:4},end:{line:130,column:7}},'32':{start:{line:126,column:8},end:{line:129,column:11}},'33':{start:{line:133,column:0},end:{line:153,column:3}},'34':{start:{line:134,column:4},end:{line:152,column:7}},'35':{start:{line:135,column:8},end:{line:151,column:11}},'36':{start:{line:136,column:12},end:{line:150,column:14}},'37':{start:{line:143,column:37},end:{line:143,column:68}},'38':{start:{line:144,column:16},end:{line:144,column:53}},'39':{start:{line:145,column:16},end:{line:149,column:18}},'40':{start:{line:155,column:0},end:{line:164,column:3}},'41':{start:{line:156,column:4},end:{line:163,column:7}},'42':{start:{line:157,column:23},end:{line:161,column:9}},'43':{start:{line:162,column:8},end:{line:162,column:27}},'44':{start:{line:166,column:0},end:{line:174,column:3}},'45':{start:{line:167,column:4},end:{line:173,column:6}},'46':{start:{line:168,column:8},end:{line:172,column:10}},'47':{start:{line:176,column:0},end:{line:236,column:3}},'48':{start:{line:177,column:4},end:{line:235,column:7}},'49':{start:{line:180,column:8},end:{line:234,column:11}},'50':{start:{line:181,column:12},end:{line:233,column:13}},'51':{start:{line:182,column:16},end:{line:185,column:19}},'52':{start:{line:187,column:16},end:{line:232,column:19}},'53':{start:{line:203,column:20},end:{line:220,column:23}},'54':{start:{line:222,column:20},end:{line:226,column:26}},'55':{start:{line:228,column:20},end:{line:231,column:23}},'56':{start:{line:238,column:0},end:{line:253,column:3}},'57':{start:{line:239,column:4},end:{line:252,column:7}},'58':{start:{line:245,column:8},end:{line:251,column:11}},'59':{start:{line:246,column:12},end:{line:248,column:15}},'60':{start:{line:249,column:13},end:{line:251,column:11}},'61':{start:{line:259,column:0},end:{line:267,column:3}},'62':{start:{line:260,column:4},end:{line:266,column:6}},'63':{start:{line:261,column:8},end:{line:265,column:10}},'64':{start:{line:268,column:0},end:{line:276,column:3}},'65':{start:{line:269,column:4},end:{line:275,column:6}},'66':{start:{line:270,column:8},end:{line:274,column:10}},'67':{start:{line:277,column:0},end:{line:285,column:3}},'68':{start:{line:278,column:4},end:{line:284,column:6}},'69':{start:{line:279,column:8},end:{line:283,column:10}},'70':{start:{line:286,column:0},end:{line:294,column:3}},'71':{start:{line:287,column:4},end:{line:293,column:6}},'72':{start:{line:288,column:8},end:{line:292,column:10}},'73':{start:{line:296,column:0},end:{line:304,column:3}},'74':{start:{line:297,column:4},end:{line:303,column:6}},'75':{start:{line:298,column:8},end:{line:302,column:10}},'76':{start:{line:306,column:0},end:{line:314,column:3}},'77':{start:{line:307,column:4},end:{line:313,column:6}},'78':{start:{line:308,column:8},end:{line:312,column:10}},'79':{start:{line:316,column:0},end:{line:324,column:3}},'80':{start:{line:317,column:4},end:{line:323,column:6}},'81':{start:{line:318,column:8},end:{line:322,column:10}},'82':{start:{line:326,column:0},end:{line:334,column:3}},'83':{start:{line:327,column:4},end:{line:333,column:6}},'84':{start:{line:328,column:8},end:{line:332,column:10}},'85':{start:{line:336,column:0},end:{line:336,column:24}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:12,column:17},end:{line:12,column:18}},loc:{start:{line:12,column:48},end:{line:14,column:5}},line:12},'1':{name:'(anonymous_1)',decl:{start:{line:15,column:14},end:{line:15,column:15}},loc:{start:{line:15,column:45},end:{line:17,column:5}},line:15},'2':{name:'(anonymous_2)',decl:{start:{line:31,column:28},end:{line:31,column:29}},loc:{start:{line:31,column:48},end:{line:39,column:1}},line:31},'3':{name:'(anonymous_3)',decl:{start:{line:32,column:45},end:{line:32,column:46}},loc:{start:{line:32,column:59},end:{line:38,column:5}},line:32},'4':{name:'(anonymous_4)',decl:{start:{line:40,column:30},end:{line:40,column:31}},loc:{start:{line:40,column:50},end:{line:48,column:1}},line:40},'5':{name:'(anonymous_5)',decl:{start:{line:41,column:30},end:{line:41,column:31}},loc:{start:{line:41,column:44},end:{line:47,column:5}},line:41},'6':{name:'(anonymous_6)',decl:{start:{line:50,column:28},end:{line:50,column:29}},loc:{start:{line:50,column:48},end:{line:84,column:1}},line:50},'7':{name:'(anonymous_7)',decl:{start:{line:52,column:51},end:{line:52,column:52}},loc:{start:{line:52,column:67},end:{line:80,column:9}},line:52},'8':{name:'(anonymous_8)',decl:{start:{line:87,column:34},end:{line:87,column:35}},loc:{start:{line:87,column:54},end:{line:114,column:1}},line:87},'9':{name:'(anonymous_9)',decl:{start:{line:107,column:12},end:{line:107,column:13}},loc:{start:{line:107,column:24},end:{line:113,column:5}},line:107},'10':{name:'(anonymous_10)',decl:{start:{line:116,column:34},end:{line:116,column:35}},loc:{start:{line:116,column:54},end:{line:131,column:1}},line:116},'11':{name:'(anonymous_11)',decl:{start:{line:125,column:12},end:{line:125,column:13}},loc:{start:{line:125,column:24},end:{line:130,column:5}},line:125},'12':{name:'(anonymous_12)',decl:{start:{line:133,column:22},end:{line:133,column:23}},loc:{start:{line:133,column:42},end:{line:153,column:1}},line:133},'13':{name:'(anonymous_13)',decl:{start:{line:134,column:21},end:{line:134,column:22}},loc:{start:{line:134,column:33},end:{line:152,column:5}},line:134},'14':{name:'(anonymous_14)',decl:{start:{line:135,column:54},end:{line:135,column:55}},loc:{start:{line:135,column:70},end:{line:151,column:9}},line:135},'15':{name:'(anonymous_15)',decl:{start:{line:142,column:20},end:{line:142,column:21}},loc:{start:{line:142,column:32},end:{line:150,column:13}},line:142},'16':{name:'(anonymous_16)',decl:{start:{line:155,column:27},end:{line:155,column:28}},loc:{start:{line:155,column:47},end:{line:164,column:1}},line:155},'17':{name:'(anonymous_17)',decl:{start:{line:156,column:28},end:{line:156,column:29}},loc:{start:{line:156,column:37},end:{line:163,column:5}},line:156},'18':{name:'(anonymous_18)',decl:{start:{line:166,column:37},end:{line:166,column:38}},loc:{start:{line:166,column:56},end:{line:174,column:1}},line:166},'19':{name:'(anonymous_19)',decl:{start:{line:167,column:56},end:{line:167,column:57}},loc:{start:{line:167,column:70},end:{line:173,column:5}},line:167},'20':{name:'(anonymous_20)',decl:{start:{line:176,column:24},end:{line:176,column:25}},loc:{start:{line:176,column:44},end:{line:236,column:1}},line:176},'21':{name:'(anonymous_21)',decl:{start:{line:179,column:12},end:{line:179,column:13}},loc:{start:{line:179,column:24},end:{line:235,column:5}},line:179},'22':{name:'(anonymous_22)',decl:{start:{line:180,column:51},end:{line:180,column:52}},loc:{start:{line:180,column:69},end:{line:234,column:9}},line:180},'23':{name:'(anonymous_23)',decl:{start:{line:202,column:24},end:{line:202,column:25}},loc:{start:{line:202,column:36},end:{line:232,column:17}},line:202},'24':{name:'(anonymous_24)',decl:{start:{line:238,column:30},end:{line:238,column:31}},loc:{start:{line:238,column:50},end:{line:253,column:1}},line:238},'25':{name:'(anonymous_25)',decl:{start:{line:244,column:12},end:{line:244,column:13}},loc:{start:{line:244,column:22},end:{line:252,column:5}},line:244},'26':{name:'(anonymous_26)',decl:{start:{line:259,column:35},end:{line:259,column:36}},loc:{start:{line:259,column:54},end:{line:267,column:1}},line:259},'27':{name:'(anonymous_27)',decl:{start:{line:260,column:36},end:{line:260,column:37}},loc:{start:{line:260,column:50},end:{line:266,column:5}},line:260},'28':{name:'(anonymous_28)',decl:{start:{line:268,column:39},end:{line:268,column:40}},loc:{start:{line:268,column:58},end:{line:276,column:1}},line:268},'29':{name:'(anonymous_29)',decl:{start:{line:269,column:40},end:{line:269,column:41}},loc:{start:{line:269,column:54},end:{line:275,column:5}},line:269},'30':{name:'(anonymous_30)',decl:{start:{line:277,column:40},end:{line:277,column:41}},loc:{start:{line:277,column:59},end:{line:285,column:1}},line:277},'31':{name:'(anonymous_31)',decl:{start:{line:278,column:41},end:{line:278,column:42}},loc:{start:{line:278,column:55},end:{line:284,column:5}},line:278},'32':{name:'(anonymous_32)',decl:{start:{line:286,column:37},end:{line:286,column:38}},loc:{start:{line:286,column:56},end:{line:294,column:1}},line:286},'33':{name:'(anonymous_33)',decl:{start:{line:287,column:38},end:{line:287,column:39}},loc:{start:{line:287,column:52},end:{line:293,column:5}},line:287},'34':{name:'(anonymous_34)',decl:{start:{line:296,column:42},end:{line:296,column:43}},loc:{start:{line:296,column:61},end:{line:304,column:1}},line:296},'35':{name:'(anonymous_35)',decl:{start:{line:297,column:42},end:{line:297,column:43}},loc:{start:{line:297,column:56},end:{line:303,column:5}},line:297},'36':{name:'(anonymous_36)',decl:{start:{line:306,column:45},end:{line:306,column:46}},loc:{start:{line:306,column:64},end:{line:314,column:1}},line:306},'37':{name:'(anonymous_37)',decl:{start:{line:307,column:65},end:{line:307,column:66}},loc:{start:{line:307,column:79},end:{line:313,column:5}},line:307},'38':{name:'(anonymous_38)',decl:{start:{line:316,column:45},end:{line:316,column:46}},loc:{start:{line:316,column:64},end:{line:324,column:1}},line:316},'39':{name:'(anonymous_39)',decl:{start:{line:317,column:63},end:{line:317,column:64}},loc:{start:{line:317,column:77},end:{line:323,column:5}},line:317},'40':{name:'(anonymous_40)',decl:{start:{line:326,column:37},end:{line:326,column:38}},loc:{start:{line:326,column:56},end:{line:334,column:1}},line:326},'41':{name:'(anonymous_41)',decl:{start:{line:327,column:51},end:{line:327,column:52}},loc:{start:{line:327,column:65},end:{line:333,column:5}},line:327}},branchMap:{'0':{loc:{start:{line:51,column:4},end:{line:83,column:5}},type:'if',locations:[{start:{line:51,column:4},end:{line:83,column:5}},{start:{line:51,column:4},end:{line:83,column:5}}],line:51},'1':{loc:{start:{line:53,column:30},end:{line:55,column:58}},type:'cond-expr',locations:[{start:{line:53,column:45},end:{line:53,column:46}},{start:{line:54,column:32},end:{line:55,column:58}}],line:53},'2':{loc:{start:{line:54,column:32},end:{line:55,column:58}},type:'cond-expr',locations:[{start:{line:54,column:49},end:{line:54,column:50}},{start:{line:55,column:36},end:{line:55,column:58}}],line:54},'3':{loc:{start:{line:55,column:36},end:{line:55,column:58}},type:'cond-expr',locations:[{start:{line:55,column:53},end:{line:55,column:54}},{start:{line:55,column:57},end:{line:55,column:58}}],line:55},'4':{loc:{start:{line:181,column:12},end:{line:233,column:13}},type:'if',locations:[{start:{line:181,column:12},end:{line:233,column:13}},{start:{line:181,column:12},end:{line:233,column:13}}],line:181},'5':{loc:{start:{line:245,column:8},end:{line:251,column:11}},type:'if',locations:[{start:{line:245,column:8},end:{line:251,column:11}},{start:{line:245,column:8},end:{line:251,column:11}}],line:245}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0,'43':0,'44':0,'45':0,'46':0,'47':0,'48':0,'49':0,'50':0,'51':0,'52':0,'53':0,'54':0,'55':0,'56':0,'57':0,'58':0,'59':0,'60':0,'61':0,'62':0,'63':0,'64':0,'65':0,'66':0,'67':0,'68':0,'69':0,'70':0,'71':0,'72':0,'73':0,'74':0,'75':0,'76':0,'77':0,'78':0,'79':0,'80':0,'81':0,'82':0,'83':0,'84':0,'85':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0],'5':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var router=(cov_2qfzt7e73w.s[0]++,require('express').Router());var models=(cov_2qfzt7e73w.s[1]++,require('../../models'));//require toiws file index.js cuar thuw mucj
var log=(cov_2qfzt7e73w.s[2]++,require('../../config/config')["log"]);var md5=(cov_2qfzt7e73w.s[3]++,require('md5'));const fs=(cov_2qfzt7e73w.s[4]++,require('fs'));var sendEmail=(cov_2qfzt7e73w.s[5]++,require('../../notification/email'));var auto=(cov_2qfzt7e73w.s[6]++,require('../../automatic'));var desktop=(cov_2qfzt7e73w.s[7]++,require('../../notification/desktop'));// Upload file setting
var multer=(cov_2qfzt7e73w.s[8]++,require('multer'));var storage=(cov_2qfzt7e73w.s[9]++,multer.diskStorage({destination:function(req,file,callback){cov_2qfzt7e73w.f[0]++;cov_2qfzt7e73w.s[10]++;callback(null,'./client/img/profiles');},filename:function(req,file,callback){cov_2qfzt7e73w.f[1]++;cov_2qfzt7e73w.s[11]++;callback(null,file.fieldname+'-'+Date.now()+file.originalname);}}));// var upload = multer({
//     storage: storage
// }).single('userPhoto');
var upload=(cov_2qfzt7e73w.s[12]++,multer({storage:storage}).any());// generate table to mysql
cov_2qfzt7e73w.s[13]++;models.User.sync({force:false});cov_2qfzt7e73w.s[14]++;router.post('/getUserById',function(req,res){cov_2qfzt7e73w.f[2]++;cov_2qfzt7e73w.s[15]++;models.User.getUserByUserID(req.body.id,function(rs){cov_2qfzt7e73w.f[3]++;cov_2qfzt7e73w.s[16]++;res.send({success:true,msg:"send user info",data:rs});});});cov_2qfzt7e73w.s[17]++;router.post('/getAllTrainer',function(req,res){cov_2qfzt7e73w.f[4]++;cov_2qfzt7e73w.s[18]++;models.User.getAllTrainer(function(rs){cov_2qfzt7e73w.f[5]++;cov_2qfzt7e73w.s[19]++;res.send({success:true,msg:"send trainer list",data:rs});});});cov_2qfzt7e73w.s[20]++;router.post('/getUserInfo',function(req,res){cov_2qfzt7e73w.f[6]++;cov_2qfzt7e73w.s[21]++;if(req.cookies.email===req.decoded.email){cov_2qfzt7e73w.b[0][0]++;cov_2qfzt7e73w.s[22]++;models.User.getUserByEmail(req.body.email,function(user){cov_2qfzt7e73w.f[7]++;var currentRole=(cov_2qfzt7e73w.s[23]++,user.isAdmin?(cov_2qfzt7e73w.b[1][0]++,1):(cov_2qfzt7e73w.b[1][1]++,user.isTrainer?(cov_2qfzt7e73w.b[2][0]++,2):(cov_2qfzt7e73w.b[2][1]++,user.isTrainee?(cov_2qfzt7e73w.b[3][0]++,3):(cov_2qfzt7e73w.b[3][1]++,0))));cov_2qfzt7e73w.s[24]++;res.send({id:user.id,username:user.username,status:user.status,dob:user.dob,phone:user.phone,location:user.location,email:user.email,password:user.password,avatar:user.avatar,role:currentRole,isAdmin:user.isAdmin,isTrainer:user.isTrainer,isTrainee:user.isTrainee,belong2Team:user.belong2Team,isExperienced:user.isExperienced,userType:user.userType,success:true,getCurrentRole:true,isNotificationDesktop:user.isNotificationDesktop,isNotificationEmail:user.isNotificationEmail,EmailPeriod:user.EmailPeriod,TimeOption:user.TimeOption});});}else{cov_2qfzt7e73w.b[0][1]++;cov_2qfzt7e73w.s[25]++;res.status(403).send('Something wrong with Authentication');}});cov_2qfzt7e73w.s[26]++;router.post('/updateUserProfile',function(req,res){cov_2qfzt7e73w.f[8]++;cov_2qfzt7e73w.s[27]++;models.User.update({username:req.body.username,avatar:req.body.avatar,dob:req.body.dob,phone:req.body.phone,status:req.body.status,isNotificationDesktop:req.body.isNotificationDesktop,isNotificationEmail:req.body.isNotificationEmail,isAdmin:req.body.isAdmin,isTrainer:req.body.isTrainer,belong2Team:req.body.belong2Team,isExperienced:req.body.isExperienced,userType:req.body.userType,EmailPeriod:req.body.EmailPeriod,TimeOption:req.body.TimeOption},{where:{email:req.body.email}}).then(function(){cov_2qfzt7e73w.f[9]++;cov_2qfzt7e73w.s[28]++;auto.job_sendEmail.updateJobs(req.body.email);cov_2qfzt7e73w.s[29]++;res.send({success:true,msg:"Update your profile Success"});});});cov_2qfzt7e73w.s[30]++;router.post('/changePasswordMD5',function(req,res){cov_2qfzt7e73w.f[10]++;cov_2qfzt7e73w.s[31]++;models.User.update({password:md5(req.body.password),status:'activated',isTrainee:true},{where:{email:req.body.email}}).then(function(){cov_2qfzt7e73w.f[11]++;cov_2qfzt7e73w.s[32]++;res.send({success:true,msg:"Update Your Password Success"});});});cov_2qfzt7e73w.s[33]++;router.post('/photo',function(req,res){cov_2qfzt7e73w.f[12]++;cov_2qfzt7e73w.s[34]++;upload(req,res,function(){cov_2qfzt7e73w.f[13]++;cov_2qfzt7e73w.s[35]++;models.User.getUserByEmail(req.headers.email,function(user){cov_2qfzt7e73w.f[14]++;cov_2qfzt7e73w.s[36]++;models.User.update({avatar:'/img/profiles/'+req.files[0].filename},{where:{email:req.headers.email}}).then(function(){cov_2qfzt7e73w.f[15]++;var previousAvatar=(cov_2qfzt7e73w.s[37]++,user._previousDataValues.avatar);cov_2qfzt7e73w.s[38]++;fs.unlink('client'+previousAvatar);cov_2qfzt7e73w.s[39]++;res.json({success:true,message:'Upload successful',link:'/img/profiles/'+req.files[0].filename});});});});});//phuong thuwcs get pharn hooif mootj GET Request vef /getAllUsers page
cov_2qfzt7e73w.s[40]++;router.get('/getAllUsers',function(req,res){cov_2qfzt7e73w.f[16]++;cov_2qfzt7e73w.s[41]++;models.User.getAllUsers(users=>{cov_2qfzt7e73w.f[17]++;var dataSend=(cov_2qfzt7e73w.s[42]++,{success:true,msg:'successfully sent',data:users});cov_2qfzt7e73w.s[43]++;res.send(dataSend);//client goij get toiws /user/userProfile/getAllUsers, phuowng thuwcs trar veef dataSend
});});cov_2qfzt7e73w.s[44]++;router.post('/getAllUserByCourseID',function(req,res){cov_2qfzt7e73w.f[18]++;cov_2qfzt7e73w.s[45]++;models.User.getAllUserByCourseID(req.body.courseID,function(rs){cov_2qfzt7e73w.f[19]++;cov_2qfzt7e73w.s[46]++;res.send({success:true,msg:"send user by courseID",data:rs});});});cov_2qfzt7e73w.s[47]++;router.post('/addUser',function(req,res){cov_2qfzt7e73w.f[20]++;cov_2qfzt7e73w.s[48]++;models.User.sync({force:false}).then(function(){cov_2qfzt7e73w.f[21]++;cov_2qfzt7e73w.s[49]++;models.User.getUserByEmail(req.body.email,function(result){cov_2qfzt7e73w.f[22]++;cov_2qfzt7e73w.s[50]++;if(result){cov_2qfzt7e73w.b[4][0]++;cov_2qfzt7e73w.s[51]++;res.send({success:false,msg:'Email already existed. Add failed!'});}else{cov_2qfzt7e73w.b[4][1]++;cov_2qfzt7e73w.s[52]++;models.User.create({username:req.body.username,status:'newuser',dob:'01/01/2001',phone:'0000 000 000',location:'DEK Vietnam',email:req.body.email,password:md5(req.body.password),avatar:'/img/profiles/defaultProfile.jpg',isAdmin:false,isTrainer:false,isTrainee:false,belong2Team:req.body.team,isExperienced:0,userType:req.body.userType}).then(function(){cov_2qfzt7e73w.f[23]++;cov_2qfzt7e73w.s[53]++;models.User.update({username:req.body.username,avatar:'/img/profiles/defaultProfile.jpg',dob:'01/01/2001',phone:'0000 000 000',status:'newuser',isNotificationDesktop:true,isNotificationEmail:true,isAdmin:false,isTrainer:false,isExperienced:false,EmailPeriod:'Daily',TimeOption:req.body.TimeOption},{where:{email:req.body.email}});cov_2qfzt7e73w.s[54]++;sendEmail.send([req.body.email],"Register - Account Information",{username:req.body.username,email:req.body.email,password:req.body.password},3);cov_2qfzt7e73w.s[55]++;res.send({success:true,msg:"Register New User Successfully"});});}});});});cov_2qfzt7e73w.s[56]++;router.post('/checkPassword',function(req,res){cov_2qfzt7e73w.f[24]++;cov_2qfzt7e73w.s[57]++;models.User.findOne({where:{email:req.body.email,password:md5(req.body.password)}}).then(result=>{cov_2qfzt7e73w.f[25]++;cov_2qfzt7e73w.s[58]++;if(result){cov_2qfzt7e73w.b[5][0]++;cov_2qfzt7e73w.s[59]++;res.send({success:true});}else{cov_2qfzt7e73w.b[5][1]++;cov_2qfzt7e73w.s[60]++;res.send({success:false});}});});// --------------------------------------------------------------- TL Team - Ngoc Thanh -------------------------------------------------------
cov_2qfzt7e73w.s[61]++;router.get('/getUserDontFeedback',function(req,res){cov_2qfzt7e73w.f[26]++;cov_2qfzt7e73w.s[62]++;models.User.getUserDontFeedback(function(rs){cov_2qfzt7e73w.f[27]++;cov_2qfzt7e73w.s[63]++;res.send({success:true,msg:"get user don't feedback in all class",data:rs});});});cov_2qfzt7e73w.s[64]++;router.get('/getUserMaxRatingTrainer',function(req,res){cov_2qfzt7e73w.f[28]++;cov_2qfzt7e73w.s[65]++;models.User.getUserMaxRatingTrainer(function(rs){cov_2qfzt7e73w.f[29]++;cov_2qfzt7e73w.s[66]++;res.send({success:true,msg:"get user vote max ratig for trainer in all class",data:rs});});});cov_2qfzt7e73w.s[67]++;router.get('/getUserMaxRatingContents',function(req,res){cov_2qfzt7e73w.f[30]++;cov_2qfzt7e73w.s[68]++;models.User.getUserMaxRatingContents(function(rs){cov_2qfzt7e73w.f[31]++;cov_2qfzt7e73w.s[69]++;res.send({success:true,msg:"get user vote max rating for contents in all class",data:rs});});});cov_2qfzt7e73w.s[70]++;router.get('/getUserMaxRatingHappy',function(req,res){cov_2qfzt7e73w.f[32]++;cov_2qfzt7e73w.s[71]++;models.User.getUserMaxRatingHappy(function(rs){cov_2qfzt7e73w.f[33]++;cov_2qfzt7e73w.s[72]++;res.send({success:true,msg:"get user vote max rating for happy in all class",data:rs});});});cov_2qfzt7e73w.s[73]++;router.post('/getUserHaveImproveComment',function(req,res){cov_2qfzt7e73w.f[34]++;cov_2qfzt7e73w.s[74]++;models.User.getUserHaveImproveComment(function(rs){cov_2qfzt7e73w.f[35]++;cov_2qfzt7e73w.s[75]++;res.send({success:true,msg:"get all user id if they have improve comment",data:rs});});});cov_2qfzt7e73w.s[76]++;router.post('/getUserDontFeedbackByCourseID',function(req,res){cov_2qfzt7e73w.f[36]++;cov_2qfzt7e73w.s[77]++;models.User.getUserDontFeedbackByCourseID(req.body.courseID,function(rs){cov_2qfzt7e73w.f[37]++;cov_2qfzt7e73w.s[78]++;res.send({success:true,msg:"get all user if they don't feedback course with course id",data:rs});});});cov_2qfzt7e73w.s[79]++;router.post('/getAllUserDontLearnByGroupID',function(req,res){cov_2qfzt7e73w.f[38]++;cov_2qfzt7e73w.s[80]++;models.User.getAllUserDontLearnByGroupID(req.body.groupID,function(rs){cov_2qfzt7e73w.f[39]++;cov_2qfzt7e73w.s[81]++;res.send({success:true,msg:"Get all user by team id",data:rs});});});cov_2qfzt7e73w.s[82]++;router.post('/getUserIDByUserEmail',function(req,res){cov_2qfzt7e73w.f[40]++;cov_2qfzt7e73w.s[83]++;models.User.getUserByEmail(req.body.userEmail,function(rs){cov_2qfzt7e73w.f[41]++;cov_2qfzt7e73w.s[84]++;res.send({success:true,msg:"Get user id by user email",data:rs});});});cov_2qfzt7e73w.s[85]++;module.exports=router;