var cov_zhuc20ese=function(){var path='D:\\DCC\\DCC\\server\\routes\\notification\\notification.js',hash='38e9a305ec2a09b25d141d4382ec8ba426920751',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'D:\\DCC\\DCC\\server\\routes\\notification\\notification.js',statementMap:{'0':{start:{line:1,column:13},end:{line:1,column:40}},'1':{start:{line:2,column:13},end:{line:2,column:36}},'2':{start:{line:5,column:4},end:{line:5,column:173}},'3':{start:{line:8,column:0},end:{line:35,column:3}},'4':{start:{line:9,column:4},end:{line:34,column:7}},'5':{start:{line:11,column:8},end:{line:18,column:15}},'6':{start:{line:19,column:8},end:{line:26,column:15}},'7':{start:{line:28,column:8},end:{line:28,column:32}},'8':{start:{line:30,column:8},end:{line:33,column:11}},'9':{start:{line:36,column:0},end:{line:55,column:3}},'10':{start:{line:37,column:4},end:{line:54,column:7}},'11':{start:{line:39,column:8},end:{line:46,column:15}},'12':{start:{line:48,column:8},end:{line:48,column:32}},'13':{start:{line:50,column:8},end:{line:53,column:11}},'14':{start:{line:57,column:0},end:{line:65,column:3}},'15':{start:{line:58,column:4},end:{line:64,column:7}},'16':{start:{line:59,column:8},end:{line:63,column:11}},'17':{start:{line:67,column:0},end:{line:75,column:3}},'18':{start:{line:68,column:4},end:{line:74,column:7}},'19':{start:{line:69,column:8},end:{line:73,column:11}},'20':{start:{line:77,column:0},end:{line:94,column:3}},'21':{start:{line:78,column:4},end:{line:93,column:11}},'22':{start:{line:89,column:12},end:{line:92,column:15}},'23':{start:{line:96,column:0},end:{line:114,column:3}},'24':{start:{line:97,column:4},end:{line:113,column:7}},'25':{start:{line:98,column:8},end:{line:112,column:15}},'26':{start:{line:108,column:16},end:{line:111,column:19}},'27':{start:{line:115,column:0},end:{line:182,column:2}},'28':{start:{line:116,column:16},end:{line:116,column:41}},'29':{start:{line:117,column:4},end:{line:132,column:5}},'30':{start:{line:118,column:8},end:{line:118,column:85}},'31':{start:{line:119,column:8},end:{line:119,column:34}},'32':{start:{line:120,column:8},end:{line:123,column:11}},'33':{start:{line:126,column:8},end:{line:126,column:85}},'34':{start:{line:127,column:8},end:{line:127,column:34}},'35':{start:{line:128,column:8},end:{line:131,column:11}},'36':{start:{line:183,column:0},end:{line:183,column:24}}},fnMap:{'0':{name:'addNoti',decl:{start:{line:4,column:15},end:{line:4,column:22}},loc:{start:{line:4,column:28},end:{line:6,column:1}},line:4},'1':{name:'(anonymous_1)',decl:{start:{line:8,column:33},end:{line:8,column:34}},loc:{start:{line:8,column:53},end:{line:35,column:1}},line:8},'2':{name:'(anonymous_2)',decl:{start:{line:9,column:85},end:{line:9,column:86}},loc:{start:{line:9,column:102},end:{line:34,column:5}},line:9},'3':{name:'(anonymous_3)',decl:{start:{line:36,column:46},end:{line:36,column:47}},loc:{start:{line:36,column:66},end:{line:55,column:1}},line:36},'4':{name:'(anonymous_4)',decl:{start:{line:37,column:94},end:{line:37,column:95}},loc:{start:{line:37,column:111},end:{line:54,column:5}},line:37},'5':{name:'(anonymous_5)',decl:{start:{line:57,column:43},end:{line:57,column:44}},loc:{start:{line:57,column:63},end:{line:65,column:1}},line:57},'6':{name:'(anonymous_6)',decl:{start:{line:58,column:69},end:{line:58,column:70}},loc:{start:{line:58,column:86},end:{line:64,column:5}},line:58},'7':{name:'(anonymous_7)',decl:{start:{line:67,column:56},end:{line:67,column:57}},loc:{start:{line:67,column:76},end:{line:75,column:1}},line:67},'8':{name:'(anonymous_8)',decl:{start:{line:68,column:82},end:{line:68,column:83}},loc:{start:{line:68,column:99},end:{line:74,column:5}},line:68},'9':{name:'(anonymous_9)',decl:{start:{line:77,column:41},end:{line:77,column:42}},loc:{start:{line:77,column:61},end:{line:94,column:1}},line:77},'10':{name:'(anonymous_10)',decl:{start:{line:88,column:16},end:{line:88,column:17}},loc:{start:{line:88,column:28},end:{line:93,column:9}},line:88},'11':{name:'(anonymous_11)',decl:{start:{line:96,column:54},end:{line:96,column:55}},loc:{start:{line:96,column:74},end:{line:114,column:1}},line:96},'12':{name:'(anonymous_12)',decl:{start:{line:97,column:65},end:{line:97,column:66}},loc:{start:{line:97,column:82},end:{line:113,column:5}},line:97},'13':{name:'(anonymous_13)',decl:{start:{line:107,column:20},end:{line:107,column:21}},loc:{start:{line:107,column:32},end:{line:112,column:13}},line:107},'14':{name:'(anonymous_14)',decl:{start:{line:115,column:32},end:{line:115,column:33}},loc:{start:{line:115,column:52},end:{line:182,column:1}},line:115}},branchMap:{'0':{loc:{start:{line:117,column:4},end:{line:132,column:5}},type:'if',locations:[{start:{line:117,column:4},end:{line:132,column:5}},{start:{line:117,column:4},end:{line:132,column:5}}],line:117}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0},b:{'0':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var router=(cov_zhuc20ese.s[0]++,require('express').Router());var models=(cov_zhuc20ese.s[1]++,require('../../models'));async function addNoti(req){cov_zhuc20ese.f[0]++;cov_zhuc20ese.s[2]++;return await models.Notifications.addNotification(req.body.email,req.body.userId,req.body.title,req.body.content,req.body.time,req.body.reference,req.body.status);}cov_zhuc20ese.s[3]++;router.post('/getNotifications',function(req,res){cov_zhuc20ese.f[1]++;cov_zhuc20ese.s[4]++;models.Notifications.getAllNotificationByUserId(req.body.userId,req.body.index,notifications=>{cov_zhuc20ese.f[2]++;cov_zhuc20ese.s[5]++;//
models.Notifications.update({status:2},{where:{userId:req.body.userId,status:1}});cov_zhuc20ese.s[6]++;models.Notifications.update({status:4},{where:{userId:req.body.userId,status:3}});//
cov_zhuc20ese.s[7]++;notifications.reverse();//
cov_zhuc20ese.s[8]++;res.send({data:notifications,msg:'got '+notifications.length+' notifications'});});});cov_zhuc20ese.s[9]++;router.post('/getNotificationsRequestCourse',function(req,res){cov_zhuc20ese.f[3]++;cov_zhuc20ese.s[10]++;models.Notifications.getAllNewNotificationsRequestCourse(req.body.userId,req.body.index,notifications=>{cov_zhuc20ese.f[4]++;cov_zhuc20ese.s[11]++;//
models.Notifications.update({status:4},{where:{userId:req.body.userId,status:3}});//
cov_zhuc20ese.s[12]++;notifications.reverse();//
cov_zhuc20ese.s[13]++;res.send({data:notifications,msg:'got '+notifications.length+' request course notifications'});});});cov_zhuc20ese.s[14]++;router.post('/getNumberofNewNotification',function(req,res){cov_zhuc20ese.f[5]++;cov_zhuc20ese.s[15]++;models.Notifications.getNumberofNewNotification(req.body.userId,notifications=>{cov_zhuc20ese.f[6]++;cov_zhuc20ese.s[16]++;res.send({data:notifications.count,success:true,msg:'got '+notifications.count+' new notifications'});});});cov_zhuc20ese.s[17]++;router.post('/getNumberofNewNotificationRequestCourse',function(req,res){cov_zhuc20ese.f[7]++;cov_zhuc20ese.s[18]++;models.Notifications.getNumberofNewNotificationRequestCourse(req.body.userId,notifications=>{cov_zhuc20ese.f[8]++;cov_zhuc20ese.s[19]++;res.send({data:notifications.count,success:true,msg:'got '+notifications.count+' new request Course notifications '});});});cov_zhuc20ese.s[20]++;router.post('/updateNotificationStatus',function(req,res){cov_zhuc20ese.f[9]++;cov_zhuc20ese.s[21]++;models.Notifications.update({status:0},{where:{userId:req.body.userId,status:{$ne:0},id:req.body.id}}).then(function(){cov_zhuc20ese.f[10]++;cov_zhuc20ese.s[22]++;res.send({success:true,msg:"Status updated"});});});cov_zhuc20ese.s[23]++;router.post('/getAllNewNotificationsAndUpdateStatus',function(req,res){cov_zhuc20ese.f[11]++;cov_zhuc20ese.s[24]++;models.Notifications.getAllNewNotifications(req.body.userId,notifications=>{cov_zhuc20ese.f[12]++;cov_zhuc20ese.s[25]++;models.Notifications.update({status:0},{where:{userId:req.body.userId,status:{$ne:0}}}).then(function(){cov_zhuc20ese.f[13]++;cov_zhuc20ese.s[26]++;res.send({data:notifications,msg:"All status updated"});});});});cov_zhuc20ese.s[27]++;router.post('/addNotification',function(req,res){cov_zhuc20ese.f[14]++;let check=(cov_zhuc20ese.s[28]++,addNoti(req).catch(alert));cov_zhuc20ese.s[29]++;if(check===0){cov_zhuc20ese.b[0][0]++;cov_zhuc20ese.s[30]++;console.log('------------------addNotification routes---------------------');cov_zhuc20ese.s[31]++;console.log('-return 0-');cov_zhuc20ese.s[32]++;res.send({result:0,msg:"Dont delete and insert new notification"});}else{cov_zhuc20ese.b[0][1]++;cov_zhuc20ese.s[33]++;console.log('------------------addNotification routes---------------------');cov_zhuc20ese.s[34]++;console.log('-return 1-');cov_zhuc20ese.s[35]++;res.send({result:1,msg:"Delete and insert new notification"});}// let check = models.Notifications.addNotification(req.body.email, req.body.userId, req.body.title, req.body.content, req.body.time, req.body.reference, req.body.status);
// if (check === 0) {
//     console.log('------------------addNotification routes---------------------');
//     console.log('-return 0-');
//     res.send({
//         result: 0,
//         msg: "Dont delete and insert new notification"
//     });
// }
// else {
//     console.log('------------------addNotification routes---------------------');
//     console.log('-return 1-');
//     res.send({
//         result: 1,
//         msg: "Delete and insert new notification"
//     });
// }
// var p2 = new Promise(function (resolve, reject) {
//     var result = models.Notifications.addNotification(req.body.email, req.body.userId, req.body.title, req.body.content, req.body.time, req.body.reference, req.body.status)
//     if (result != -1) {
//         resolve(result);
//     }
//     else {
//         reject(result);
//     }
// });
// p2.then(function (check) {
//     if (check == 0) {
//         console.log('--------------addNotification routes--------------');
//         console.log('-return 0-');
//         res.send({
//             result: 0,
//             msg: "Dont delete and insert new notification"
//         });
//     }
//     else {
//         console.log('--------------addNotification routes--------------');
//         console.log('-return 1-');
//         res.send({
//             result: 1,
//             msg: "delete and insert new notification"
//         });
//     }
// })
});cov_zhuc20ese.s[36]++;module.exports=router;