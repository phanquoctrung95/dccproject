var cov_zhuc20ese=function(){var path='D:\\DCC\\DCC\\server\\routes\\notification\\notification.js',hash='41b6ec9a74edf03ce0b0e66d9c43e88b989cdf7b',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'D:\\DCC\\DCC\\server\\routes\\notification\\notification.js',statementMap:{'0':{start:{line:1,column:13},end:{line:1,column:40}},'1':{start:{line:2,column:13},end:{line:2,column:36}},'2':{start:{line:5,column:18},end:{line:9,column:5}},'3':{start:{line:6,column:8},end:{line:8,column:11}},'4':{start:{line:7,column:12},end:{line:7,column:177}},'5':{start:{line:10,column:4},end:{line:10,column:97}},'6':{start:{line:11,column:4},end:{line:11,column:17}},'7':{start:{line:14,column:0},end:{line:41,column:3}},'8':{start:{line:15,column:4},end:{line:40,column:7}},'9':{start:{line:17,column:8},end:{line:24,column:15}},'10':{start:{line:25,column:8},end:{line:32,column:15}},'11':{start:{line:34,column:8},end:{line:34,column:32}},'12':{start:{line:36,column:8},end:{line:39,column:11}},'13':{start:{line:42,column:0},end:{line:61,column:3}},'14':{start:{line:43,column:4},end:{line:60,column:7}},'15':{start:{line:45,column:8},end:{line:52,column:15}},'16':{start:{line:54,column:8},end:{line:54,column:32}},'17':{start:{line:56,column:8},end:{line:59,column:11}},'18':{start:{line:63,column:0},end:{line:71,column:3}},'19':{start:{line:64,column:4},end:{line:70,column:7}},'20':{start:{line:65,column:8},end:{line:69,column:11}},'21':{start:{line:73,column:0},end:{line:81,column:3}},'22':{start:{line:74,column:4},end:{line:80,column:7}},'23':{start:{line:75,column:8},end:{line:79,column:11}},'24':{start:{line:83,column:0},end:{line:100,column:3}},'25':{start:{line:84,column:4},end:{line:99,column:11}},'26':{start:{line:95,column:12},end:{line:98,column:15}},'27':{start:{line:102,column:0},end:{line:120,column:3}},'28':{start:{line:103,column:4},end:{line:119,column:7}},'29':{start:{line:104,column:8},end:{line:118,column:15}},'30':{start:{line:114,column:16},end:{line:117,column:19}},'31':{start:{line:121,column:0},end:{line:191,column:2}},'32':{start:{line:123,column:4},end:{line:140,column:7}},'33':{start:{line:124,column:8},end:{line:139,column:9}},'34':{start:{line:125,column:12},end:{line:125,column:89}},'35':{start:{line:126,column:12},end:{line:126,column:38}},'36':{start:{line:127,column:12},end:{line:130,column:15}},'37':{start:{line:133,column:12},end:{line:133,column:89}},'38':{start:{line:134,column:12},end:{line:134,column:38}},'39':{start:{line:135,column:12},end:{line:138,column:15}},'40':{start:{line:192,column:0},end:{line:192,column:24}}},fnMap:{'0':{name:'addNoti',decl:{start:{line:4,column:15},end:{line:4,column:22}},loc:{start:{line:4,column:28},end:{line:12,column:1}},line:4},'1':{name:'(anonymous_1)',decl:{start:{line:5,column:24},end:{line:5,column:25}},loc:{start:{line:5,column:39},end:{line:9,column:5}},line:5},'2':{name:'(anonymous_2)',decl:{start:{line:6,column:27},end:{line:6,column:28}},loc:{start:{line:6,column:38},end:{line:8,column:9}},line:6},'3':{name:'(anonymous_3)',decl:{start:{line:14,column:33},end:{line:14,column:34}},loc:{start:{line:14,column:53},end:{line:41,column:1}},line:14},'4':{name:'(anonymous_4)',decl:{start:{line:15,column:85},end:{line:15,column:86}},loc:{start:{line:15,column:102},end:{line:40,column:5}},line:15},'5':{name:'(anonymous_5)',decl:{start:{line:42,column:46},end:{line:42,column:47}},loc:{start:{line:42,column:66},end:{line:61,column:1}},line:42},'6':{name:'(anonymous_6)',decl:{start:{line:43,column:94},end:{line:43,column:95}},loc:{start:{line:43,column:111},end:{line:60,column:5}},line:43},'7':{name:'(anonymous_7)',decl:{start:{line:63,column:43},end:{line:63,column:44}},loc:{start:{line:63,column:63},end:{line:71,column:1}},line:63},'8':{name:'(anonymous_8)',decl:{start:{line:64,column:69},end:{line:64,column:70}},loc:{start:{line:64,column:86},end:{line:70,column:5}},line:64},'9':{name:'(anonymous_9)',decl:{start:{line:73,column:56},end:{line:73,column:57}},loc:{start:{line:73,column:76},end:{line:81,column:1}},line:73},'10':{name:'(anonymous_10)',decl:{start:{line:74,column:82},end:{line:74,column:83}},loc:{start:{line:74,column:99},end:{line:80,column:5}},line:74},'11':{name:'(anonymous_11)',decl:{start:{line:83,column:41},end:{line:83,column:42}},loc:{start:{line:83,column:61},end:{line:100,column:1}},line:83},'12':{name:'(anonymous_12)',decl:{start:{line:94,column:16},end:{line:94,column:17}},loc:{start:{line:94,column:28},end:{line:99,column:9}},line:94},'13':{name:'(anonymous_13)',decl:{start:{line:102,column:54},end:{line:102,column:55}},loc:{start:{line:102,column:74},end:{line:120,column:1}},line:102},'14':{name:'(anonymous_14)',decl:{start:{line:103,column:65},end:{line:103,column:66}},loc:{start:{line:103,column:82},end:{line:119,column:5}},line:103},'15':{name:'(anonymous_15)',decl:{start:{line:113,column:20},end:{line:113,column:21}},loc:{start:{line:113,column:32},end:{line:118,column:13}},line:113},'16':{name:'(anonymous_16)',decl:{start:{line:121,column:32},end:{line:121,column:33}},loc:{start:{line:121,column:52},end:{line:191,column:1}},line:121},'17':{name:'(anonymous_17)',decl:{start:{line:123,column:22},end:{line:123,column:23}},loc:{start:{line:123,column:33},end:{line:140,column:5}},line:123}},branchMap:{'0':{loc:{start:{line:124,column:8},end:{line:139,column:9}},type:'if',locations:[{start:{line:124,column:8},end:{line:139,column:9}},{start:{line:124,column:8},end:{line:139,column:9}}],line:124}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0},b:{'0':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var router=(cov_zhuc20ese.s[0]++,require('express').Router());var models=(cov_zhuc20ese.s[1]++,require('../../models'));async function addNoti(req){cov_zhuc20ese.f[0]++;const check=(cov_zhuc20ese.s[2]++,await function(req){cov_zhuc20ese.f[1]++;cov_zhuc20ese.s[3]++;return new Promise(resolve=>{cov_zhuc20ese.f[2]++;cov_zhuc20ese.s[4]++;resolve(models.Notifications.addNotification(req.body.email,req.body.userId,req.body.title,req.body.content,req.body.time,req.body.reference,req.body.status));});});cov_zhuc20ese.s[5]++;console.log('------------------addNoti routes function: '+check+'---------------------');cov_zhuc20ese.s[6]++;return check;}cov_zhuc20ese.s[7]++;router.post('/getNotifications',function(req,res){cov_zhuc20ese.f[3]++;cov_zhuc20ese.s[8]++;models.Notifications.getAllNotificationByUserId(req.body.userId,req.body.index,notifications=>{cov_zhuc20ese.f[4]++;cov_zhuc20ese.s[9]++;//
models.Notifications.update({status:2},{where:{userId:req.body.userId,status:1}});cov_zhuc20ese.s[10]++;models.Notifications.update({status:4},{where:{userId:req.body.userId,status:3}});//
cov_zhuc20ese.s[11]++;notifications.reverse();//
cov_zhuc20ese.s[12]++;res.send({data:notifications,msg:'got '+notifications.length+' notifications'});});});cov_zhuc20ese.s[13]++;router.post('/getNotificationsRequestCourse',function(req,res){cov_zhuc20ese.f[5]++;cov_zhuc20ese.s[14]++;models.Notifications.getAllNewNotificationsRequestCourse(req.body.userId,req.body.index,notifications=>{cov_zhuc20ese.f[6]++;cov_zhuc20ese.s[15]++;//
models.Notifications.update({status:4},{where:{userId:req.body.userId,status:3}});//
cov_zhuc20ese.s[16]++;notifications.reverse();//
cov_zhuc20ese.s[17]++;res.send({data:notifications,msg:'got '+notifications.length+' request course notifications'});});});cov_zhuc20ese.s[18]++;router.post('/getNumberofNewNotification',function(req,res){cov_zhuc20ese.f[7]++;cov_zhuc20ese.s[19]++;models.Notifications.getNumberofNewNotification(req.body.userId,notifications=>{cov_zhuc20ese.f[8]++;cov_zhuc20ese.s[20]++;res.send({data:notifications.count,success:true,msg:'got '+notifications.count+' new notifications'});});});cov_zhuc20ese.s[21]++;router.post('/getNumberofNewNotificationRequestCourse',function(req,res){cov_zhuc20ese.f[9]++;cov_zhuc20ese.s[22]++;models.Notifications.getNumberofNewNotificationRequestCourse(req.body.userId,notifications=>{cov_zhuc20ese.f[10]++;cov_zhuc20ese.s[23]++;res.send({data:notifications.count,success:true,msg:'got '+notifications.count+' new request Course notifications '});});});cov_zhuc20ese.s[24]++;router.post('/updateNotificationStatus',function(req,res){cov_zhuc20ese.f[11]++;cov_zhuc20ese.s[25]++;models.Notifications.update({status:0},{where:{userId:req.body.userId,status:{$ne:0},id:req.body.id}}).then(function(){cov_zhuc20ese.f[12]++;cov_zhuc20ese.s[26]++;res.send({success:true,msg:"Status updated"});});});cov_zhuc20ese.s[27]++;router.post('/getAllNewNotificationsAndUpdateStatus',function(req,res){cov_zhuc20ese.f[13]++;cov_zhuc20ese.s[28]++;models.Notifications.getAllNewNotifications(req.body.userId,notifications=>{cov_zhuc20ese.f[14]++;cov_zhuc20ese.s[29]++;models.Notifications.update({status:0},{where:{userId:req.body.userId,status:{$ne:0}}}).then(function(){cov_zhuc20ese.f[15]++;cov_zhuc20ese.s[30]++;res.send({data:notifications,msg:"All status updated"});});});});cov_zhuc20ese.s[31]++;router.post('/addNotification',function(req,res){cov_zhuc20ese.f[16]++;cov_zhuc20ese.s[32]++;//let check = await models.Notifications.addNotification(req.body.email, req.body.userId, req.body.title, req.body.content, req.body.time, req.body.reference, req.body.status);
addNoti(req).then(check=>{cov_zhuc20ese.f[17]++;cov_zhuc20ese.s[33]++;if(check===0){cov_zhuc20ese.b[0][0]++;cov_zhuc20ese.s[34]++;console.log('------------------addNotification routes---------------------');cov_zhuc20ese.s[35]++;console.log('-return 0-');cov_zhuc20ese.s[36]++;res.send({result:0,msg:"Dont delete and insert new notification"});}else{cov_zhuc20ese.b[0][1]++;cov_zhuc20ese.s[37]++;console.log('------------------addNotification routes---------------------');cov_zhuc20ese.s[38]++;console.log('-return 1-');cov_zhuc20ese.s[39]++;res.send({result:1,msg:"Delete and insert new notification"});}});// let check = models.Notifications.addNotification(req.body.email, req.body.userId, req.body.title, req.body.content, req.body.time, req.body.reference, req.body.status);
// if (check === 0) {
//     console.log('------------------addNotification routes---------------------');
//     console.log('-return 0-');
//     res.send({
//         result: 0,
//         msg: "Dont delete and insert new notification"
//     });
// }
// else {
//     console.log('------------------addNotification routes---------------------');
//     console.log('-return 1-');
//     res.send({
//         result: 1,
//         msg: "Delete and insert new notification"
//     });
// }
// var p2 = new Promise(function (resolve, reject) {
//     var result = models.Notifications.addNotification(req.body.email, req.body.userId, req.body.title, req.body.content, req.body.time, req.body.reference, req.body.status)
//     if (result != -1) {
//         resolve(result);
//     }
//     else {
//         reject(result);
//     }
// });
// p2.then(function (check) {
//     if (check == 0) {
//         console.log('--------------addNotification routes--------------');
//         console.log('-return 0-');
//         res.send({
//             result: 0,
//             msg: "Dont delete and insert new notification"
//         });
//     }
//     else {
//         console.log('--------------addNotification routes--------------');
//         console.log('-return 1-');
//         res.send({
//             result: 1,
//             msg: "delete and insert new notification"
//         });
//     }
// })
});cov_zhuc20ese.s[40]++;module.exports=router;