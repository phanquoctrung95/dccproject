var cov_zhuc20ese=function(){var path='D:\\DCC\\DCC\\server\\routes\\notification\\notification.js',hash='4f04c6e1cc88ce60a2026e025bf76a399e736b0a',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'D:\\DCC\\DCC\\server\\routes\\notification\\notification.js',statementMap:{'0':{start:{line:1,column:13},end:{line:1,column:40}},'1':{start:{line:2,column:13},end:{line:2,column:36}},'2':{start:{line:5,column:4},end:{line:9,column:7}},'3':{start:{line:6,column:8},end:{line:8,column:17}},'4':{start:{line:7,column:12},end:{line:7,column:177}},'5':{start:{line:12,column:18},end:{line:12,column:36}},'6':{start:{line:13,column:4},end:{line:13,column:97}},'7':{start:{line:14,column:4},end:{line:14,column:17}},'8':{start:{line:17,column:0},end:{line:44,column:3}},'9':{start:{line:18,column:4},end:{line:43,column:7}},'10':{start:{line:20,column:8},end:{line:27,column:15}},'11':{start:{line:28,column:8},end:{line:35,column:15}},'12':{start:{line:37,column:8},end:{line:37,column:32}},'13':{start:{line:39,column:8},end:{line:42,column:11}},'14':{start:{line:45,column:0},end:{line:64,column:3}},'15':{start:{line:46,column:4},end:{line:63,column:7}},'16':{start:{line:48,column:8},end:{line:55,column:15}},'17':{start:{line:57,column:8},end:{line:57,column:32}},'18':{start:{line:59,column:8},end:{line:62,column:11}},'19':{start:{line:66,column:0},end:{line:74,column:3}},'20':{start:{line:67,column:4},end:{line:73,column:7}},'21':{start:{line:68,column:8},end:{line:72,column:11}},'22':{start:{line:76,column:0},end:{line:84,column:3}},'23':{start:{line:77,column:4},end:{line:83,column:7}},'24':{start:{line:78,column:8},end:{line:82,column:11}},'25':{start:{line:86,column:0},end:{line:103,column:3}},'26':{start:{line:87,column:4},end:{line:102,column:11}},'27':{start:{line:98,column:12},end:{line:101,column:15}},'28':{start:{line:105,column:0},end:{line:123,column:3}},'29':{start:{line:106,column:4},end:{line:122,column:7}},'30':{start:{line:107,column:8},end:{line:121,column:15}},'31':{start:{line:117,column:16},end:{line:120,column:19}},'32':{start:{line:124,column:0},end:{line:194,column:2}},'33':{start:{line:126,column:4},end:{line:143,column:7}},'34':{start:{line:127,column:8},end:{line:142,column:9}},'35':{start:{line:128,column:12},end:{line:128,column:89}},'36':{start:{line:129,column:12},end:{line:129,column:38}},'37':{start:{line:130,column:12},end:{line:133,column:15}},'38':{start:{line:136,column:12},end:{line:136,column:89}},'39':{start:{line:137,column:12},end:{line:137,column:38}},'40':{start:{line:138,column:12},end:{line:141,column:15}},'41':{start:{line:195,column:0},end:{line:195,column:24}}},fnMap:{'0':{name:'addnoti',decl:{start:{line:4,column:9},end:{line:4,column:16}},loc:{start:{line:4,column:22},end:{line:10,column:1}},line:4},'1':{name:'(anonymous_1)',decl:{start:{line:5,column:23},end:{line:5,column:24}},loc:{start:{line:5,column:34},end:{line:9,column:5}},line:5},'2':{name:'(anonymous_2)',decl:{start:{line:6,column:19},end:{line:6,column:20}},loc:{start:{line:6,column:25},end:{line:8,column:9}},line:6},'3':{name:'addNoti',decl:{start:{line:11,column:15},end:{line:11,column:22}},loc:{start:{line:11,column:28},end:{line:15,column:1}},line:11},'4':{name:'(anonymous_4)',decl:{start:{line:17,column:33},end:{line:17,column:34}},loc:{start:{line:17,column:53},end:{line:44,column:1}},line:17},'5':{name:'(anonymous_5)',decl:{start:{line:18,column:85},end:{line:18,column:86}},loc:{start:{line:18,column:102},end:{line:43,column:5}},line:18},'6':{name:'(anonymous_6)',decl:{start:{line:45,column:46},end:{line:45,column:47}},loc:{start:{line:45,column:66},end:{line:64,column:1}},line:45},'7':{name:'(anonymous_7)',decl:{start:{line:46,column:94},end:{line:46,column:95}},loc:{start:{line:46,column:111},end:{line:63,column:5}},line:46},'8':{name:'(anonymous_8)',decl:{start:{line:66,column:43},end:{line:66,column:44}},loc:{start:{line:66,column:63},end:{line:74,column:1}},line:66},'9':{name:'(anonymous_9)',decl:{start:{line:67,column:69},end:{line:67,column:70}},loc:{start:{line:67,column:86},end:{line:73,column:5}},line:67},'10':{name:'(anonymous_10)',decl:{start:{line:76,column:56},end:{line:76,column:57}},loc:{start:{line:76,column:76},end:{line:84,column:1}},line:76},'11':{name:'(anonymous_11)',decl:{start:{line:77,column:82},end:{line:77,column:83}},loc:{start:{line:77,column:99},end:{line:83,column:5}},line:77},'12':{name:'(anonymous_12)',decl:{start:{line:86,column:41},end:{line:86,column:42}},loc:{start:{line:86,column:61},end:{line:103,column:1}},line:86},'13':{name:'(anonymous_13)',decl:{start:{line:97,column:16},end:{line:97,column:17}},loc:{start:{line:97,column:28},end:{line:102,column:9}},line:97},'14':{name:'(anonymous_14)',decl:{start:{line:105,column:54},end:{line:105,column:55}},loc:{start:{line:105,column:74},end:{line:123,column:1}},line:105},'15':{name:'(anonymous_15)',decl:{start:{line:106,column:65},end:{line:106,column:66}},loc:{start:{line:106,column:82},end:{line:122,column:5}},line:106},'16':{name:'(anonymous_16)',decl:{start:{line:116,column:20},end:{line:116,column:21}},loc:{start:{line:116,column:32},end:{line:121,column:13}},line:116},'17':{name:'(anonymous_17)',decl:{start:{line:124,column:32},end:{line:124,column:33}},loc:{start:{line:124,column:52},end:{line:194,column:1}},line:124},'18':{name:'(anonymous_18)',decl:{start:{line:126,column:22},end:{line:126,column:23}},loc:{start:{line:126,column:33},end:{line:143,column:5}},line:126}},branchMap:{'0':{loc:{start:{line:127,column:8},end:{line:142,column:9}},type:'if',locations:[{start:{line:127,column:8},end:{line:142,column:9}},{start:{line:127,column:8},end:{line:142,column:9}}],line:127}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0},b:{'0':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var router=(cov_zhuc20ese.s[0]++,require('express').Router());var models=(cov_zhuc20ese.s[1]++,require('../../models'));function addnoti(req){cov_zhuc20ese.f[0]++;cov_zhuc20ese.s[2]++;return new Promise(resolve=>{cov_zhuc20ese.f[1]++;cov_zhuc20ese.s[3]++;setTimeout(()=>{cov_zhuc20ese.f[2]++;cov_zhuc20ese.s[4]++;resolve(models.Notifications.addNotification(req.body.email,req.body.userId,req.body.title,req.body.content,req.body.time,req.body.reference,req.body.status));},1000);});}async function addNoti(req){cov_zhuc20ese.f[3]++;const check=(cov_zhuc20ese.s[5]++,await addnoti(req));cov_zhuc20ese.s[6]++;console.log('------------------addNoti routes function: '+check+'---------------------');cov_zhuc20ese.s[7]++;return check;}cov_zhuc20ese.s[8]++;router.post('/getNotifications',function(req,res){cov_zhuc20ese.f[4]++;cov_zhuc20ese.s[9]++;models.Notifications.getAllNotificationByUserId(req.body.userId,req.body.index,notifications=>{cov_zhuc20ese.f[5]++;cov_zhuc20ese.s[10]++;//
models.Notifications.update({status:2},{where:{userId:req.body.userId,status:1}});cov_zhuc20ese.s[11]++;models.Notifications.update({status:4},{where:{userId:req.body.userId,status:3}});//
cov_zhuc20ese.s[12]++;notifications.reverse();//
cov_zhuc20ese.s[13]++;res.send({data:notifications,msg:'got '+notifications.length+' notifications'});});});cov_zhuc20ese.s[14]++;router.post('/getNotificationsRequestCourse',function(req,res){cov_zhuc20ese.f[6]++;cov_zhuc20ese.s[15]++;models.Notifications.getAllNewNotificationsRequestCourse(req.body.userId,req.body.index,notifications=>{cov_zhuc20ese.f[7]++;cov_zhuc20ese.s[16]++;//
models.Notifications.update({status:4},{where:{userId:req.body.userId,status:3}});//
cov_zhuc20ese.s[17]++;notifications.reverse();//
cov_zhuc20ese.s[18]++;res.send({data:notifications,msg:'got '+notifications.length+' request course notifications'});});});cov_zhuc20ese.s[19]++;router.post('/getNumberofNewNotification',function(req,res){cov_zhuc20ese.f[8]++;cov_zhuc20ese.s[20]++;models.Notifications.getNumberofNewNotification(req.body.userId,notifications=>{cov_zhuc20ese.f[9]++;cov_zhuc20ese.s[21]++;res.send({data:notifications.count,success:true,msg:'got '+notifications.count+' new notifications'});});});cov_zhuc20ese.s[22]++;router.post('/getNumberofNewNotificationRequestCourse',function(req,res){cov_zhuc20ese.f[10]++;cov_zhuc20ese.s[23]++;models.Notifications.getNumberofNewNotificationRequestCourse(req.body.userId,notifications=>{cov_zhuc20ese.f[11]++;cov_zhuc20ese.s[24]++;res.send({data:notifications.count,success:true,msg:'got '+notifications.count+' new request Course notifications '});});});cov_zhuc20ese.s[25]++;router.post('/updateNotificationStatus',function(req,res){cov_zhuc20ese.f[12]++;cov_zhuc20ese.s[26]++;models.Notifications.update({status:0},{where:{userId:req.body.userId,status:{$ne:0},id:req.body.id}}).then(function(){cov_zhuc20ese.f[13]++;cov_zhuc20ese.s[27]++;res.send({success:true,msg:"Status updated"});});});cov_zhuc20ese.s[28]++;router.post('/getAllNewNotificationsAndUpdateStatus',function(req,res){cov_zhuc20ese.f[14]++;cov_zhuc20ese.s[29]++;models.Notifications.getAllNewNotifications(req.body.userId,notifications=>{cov_zhuc20ese.f[15]++;cov_zhuc20ese.s[30]++;models.Notifications.update({status:0},{where:{userId:req.body.userId,status:{$ne:0}}}).then(function(){cov_zhuc20ese.f[16]++;cov_zhuc20ese.s[31]++;res.send({data:notifications,msg:"All status updated"});});});});cov_zhuc20ese.s[32]++;router.post('/addNotification',function(req,res){cov_zhuc20ese.f[17]++;cov_zhuc20ese.s[33]++;//let check = await models.Notifications.addNotification(req.body.email, req.body.userId, req.body.title, req.body.content, req.body.time, req.body.reference, req.body.status);
addNoti(req).then(check=>{cov_zhuc20ese.f[18]++;cov_zhuc20ese.s[34]++;if(check===0){cov_zhuc20ese.b[0][0]++;cov_zhuc20ese.s[35]++;console.log('------------------addNotification routes---------------------');cov_zhuc20ese.s[36]++;console.log('-return 0-');cov_zhuc20ese.s[37]++;res.send({result:0,msg:"Dont delete and insert new notification"});}else{cov_zhuc20ese.b[0][1]++;cov_zhuc20ese.s[38]++;console.log('------------------addNotification routes---------------------');cov_zhuc20ese.s[39]++;console.log('-return 1-');cov_zhuc20ese.s[40]++;res.send({result:1,msg:"Delete and insert new notification"});}});// let check = models.Notifications.addNotification(req.body.email, req.body.userId, req.body.title, req.body.content, req.body.time, req.body.reference, req.body.status);
// if (check === 0) {
//     console.log('------------------addNotification routes---------------------');
//     console.log('-return 0-');
//     res.send({
//         result: 0,
//         msg: "Dont delete and insert new notification"
//     });
// }
// else {
//     console.log('------------------addNotification routes---------------------');
//     console.log('-return 1-');
//     res.send({
//         result: 1,
//         msg: "Delete and insert new notification"
//     });
// }
// var p2 = new Promise(function (resolve, reject) {
//     var result = models.Notifications.addNotification(req.body.email, req.body.userId, req.body.title, req.body.content, req.body.time, req.body.reference, req.body.status)
//     if (result != -1) {
//         resolve(result);
//     }
//     else {
//         reject(result);
//     }
// });
// p2.then(function (check) {
//     if (check == 0) {
//         console.log('--------------addNotification routes--------------');
//         console.log('-return 0-');
//         res.send({
//             result: 0,
//             msg: "Dont delete and insert new notification"
//         });
//     }
//     else {
//         console.log('--------------addNotification routes--------------');
//         console.log('-return 1-');
//         res.send({
//             result: 1,
//             msg: "delete and insert new notification"
//         });
//     }
// })
});cov_zhuc20ese.s[41]++;module.exports=router;