var cov_zhuc20ese=function(){var path='D:\\DCC\\DCC\\server\\routes\\notification\\notification.js',hash='73a6482471b8ef83c8d9a0c377867c17a9021ff9',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'D:\\DCC\\DCC\\server\\routes\\notification\\notification.js',statementMap:{'0':{start:{line:1,column:13},end:{line:1,column:40}},'1':{start:{line:2,column:13},end:{line:2,column:36}},'2':{start:{line:5,column:18},end:{line:5,column:179}},'3':{start:{line:6,column:4},end:{line:6,column:93}},'4':{start:{line:7,column:4},end:{line:7,column:17}},'5':{start:{line:10,column:0},end:{line:37,column:3}},'6':{start:{line:11,column:4},end:{line:36,column:7}},'7':{start:{line:13,column:8},end:{line:20,column:15}},'8':{start:{line:21,column:8},end:{line:28,column:15}},'9':{start:{line:30,column:8},end:{line:30,column:32}},'10':{start:{line:32,column:8},end:{line:35,column:11}},'11':{start:{line:38,column:0},end:{line:57,column:3}},'12':{start:{line:39,column:4},end:{line:56,column:7}},'13':{start:{line:41,column:8},end:{line:48,column:15}},'14':{start:{line:50,column:8},end:{line:50,column:32}},'15':{start:{line:52,column:8},end:{line:55,column:11}},'16':{start:{line:59,column:0},end:{line:67,column:3}},'17':{start:{line:60,column:4},end:{line:66,column:7}},'18':{start:{line:61,column:8},end:{line:65,column:11}},'19':{start:{line:69,column:0},end:{line:77,column:3}},'20':{start:{line:70,column:4},end:{line:76,column:7}},'21':{start:{line:71,column:8},end:{line:75,column:11}},'22':{start:{line:79,column:0},end:{line:96,column:3}},'23':{start:{line:80,column:4},end:{line:95,column:11}},'24':{start:{line:91,column:12},end:{line:94,column:15}},'25':{start:{line:98,column:0},end:{line:116,column:3}},'26':{start:{line:99,column:4},end:{line:115,column:7}},'27':{start:{line:100,column:8},end:{line:114,column:15}},'28':{start:{line:110,column:16},end:{line:113,column:19}},'29':{start:{line:117,column:0},end:{line:187,column:2}},'30':{start:{line:119,column:4},end:{line:136,column:7}},'31':{start:{line:120,column:8},end:{line:135,column:9}},'32':{start:{line:121,column:12},end:{line:121,column:89}},'33':{start:{line:122,column:12},end:{line:122,column:38}},'34':{start:{line:123,column:12},end:{line:126,column:15}},'35':{start:{line:129,column:12},end:{line:129,column:89}},'36':{start:{line:130,column:12},end:{line:130,column:38}},'37':{start:{line:131,column:12},end:{line:134,column:15}},'38':{start:{line:188,column:0},end:{line:188,column:24}}},fnMap:{'0':{name:'addNoti',decl:{start:{line:4,column:15},end:{line:4,column:22}},loc:{start:{line:4,column:28},end:{line:8,column:1}},line:4},'1':{name:'(anonymous_1)',decl:{start:{line:10,column:33},end:{line:10,column:34}},loc:{start:{line:10,column:53},end:{line:37,column:1}},line:10},'2':{name:'(anonymous_2)',decl:{start:{line:11,column:85},end:{line:11,column:86}},loc:{start:{line:11,column:102},end:{line:36,column:5}},line:11},'3':{name:'(anonymous_3)',decl:{start:{line:38,column:46},end:{line:38,column:47}},loc:{start:{line:38,column:66},end:{line:57,column:1}},line:38},'4':{name:'(anonymous_4)',decl:{start:{line:39,column:94},end:{line:39,column:95}},loc:{start:{line:39,column:111},end:{line:56,column:5}},line:39},'5':{name:'(anonymous_5)',decl:{start:{line:59,column:43},end:{line:59,column:44}},loc:{start:{line:59,column:63},end:{line:67,column:1}},line:59},'6':{name:'(anonymous_6)',decl:{start:{line:60,column:69},end:{line:60,column:70}},loc:{start:{line:60,column:86},end:{line:66,column:5}},line:60},'7':{name:'(anonymous_7)',decl:{start:{line:69,column:56},end:{line:69,column:57}},loc:{start:{line:69,column:76},end:{line:77,column:1}},line:69},'8':{name:'(anonymous_8)',decl:{start:{line:70,column:82},end:{line:70,column:83}},loc:{start:{line:70,column:99},end:{line:76,column:5}},line:70},'9':{name:'(anonymous_9)',decl:{start:{line:79,column:41},end:{line:79,column:42}},loc:{start:{line:79,column:61},end:{line:96,column:1}},line:79},'10':{name:'(anonymous_10)',decl:{start:{line:90,column:16},end:{line:90,column:17}},loc:{start:{line:90,column:28},end:{line:95,column:9}},line:90},'11':{name:'(anonymous_11)',decl:{start:{line:98,column:54},end:{line:98,column:55}},loc:{start:{line:98,column:74},end:{line:116,column:1}},line:98},'12':{name:'(anonymous_12)',decl:{start:{line:99,column:65},end:{line:99,column:66}},loc:{start:{line:99,column:82},end:{line:115,column:5}},line:99},'13':{name:'(anonymous_13)',decl:{start:{line:109,column:20},end:{line:109,column:21}},loc:{start:{line:109,column:32},end:{line:114,column:13}},line:109},'14':{name:'(anonymous_14)',decl:{start:{line:117,column:31},end:{line:117,column:32}},loc:{start:{line:117,column:51},end:{line:187,column:1}},line:117},'15':{name:'(anonymous_15)',decl:{start:{line:119,column:22},end:{line:119,column:23}},loc:{start:{line:119,column:33},end:{line:136,column:5}},line:119}},branchMap:{'0':{loc:{start:{line:120,column:8},end:{line:135,column:9}},type:'if',locations:[{start:{line:120,column:8},end:{line:135,column:9}},{start:{line:120,column:8},end:{line:135,column:9}}],line:120}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0},b:{'0':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var router=(cov_zhuc20ese.s[0]++,require('express').Router());var models=(cov_zhuc20ese.s[1]++,require('../../models'));async function addNoti(req){cov_zhuc20ese.f[0]++;const check=(cov_zhuc20ese.s[2]++,await models.Notifications.addNotification(req.body.email,req.body.userId,req.body.title,req.body.content,req.body.time,req.body.reference,req.body.status));cov_zhuc20ese.s[3]++;console.log('------------------addNoti routes function: '+check+'---------------------');cov_zhuc20ese.s[4]++;return check;}cov_zhuc20ese.s[5]++;router.post('/getNotifications',function(req,res){cov_zhuc20ese.f[1]++;cov_zhuc20ese.s[6]++;models.Notifications.getAllNotificationByUserId(req.body.userId,req.body.index,notifications=>{cov_zhuc20ese.f[2]++;cov_zhuc20ese.s[7]++;//
models.Notifications.update({status:2},{where:{userId:req.body.userId,status:1}});cov_zhuc20ese.s[8]++;models.Notifications.update({status:4},{where:{userId:req.body.userId,status:3}});//
cov_zhuc20ese.s[9]++;notifications.reverse();//
cov_zhuc20ese.s[10]++;res.send({data:notifications,msg:'got '+notifications.length+' notifications'});});});cov_zhuc20ese.s[11]++;router.post('/getNotificationsRequestCourse',function(req,res){cov_zhuc20ese.f[3]++;cov_zhuc20ese.s[12]++;models.Notifications.getAllNewNotificationsRequestCourse(req.body.userId,req.body.index,notifications=>{cov_zhuc20ese.f[4]++;cov_zhuc20ese.s[13]++;//
models.Notifications.update({status:4},{where:{userId:req.body.userId,status:3}});//
cov_zhuc20ese.s[14]++;notifications.reverse();//
cov_zhuc20ese.s[15]++;res.send({data:notifications,msg:'got '+notifications.length+' request course notifications'});});});cov_zhuc20ese.s[16]++;router.post('/getNumberofNewNotification',function(req,res){cov_zhuc20ese.f[5]++;cov_zhuc20ese.s[17]++;models.Notifications.getNumberofNewNotification(req.body.userId,notifications=>{cov_zhuc20ese.f[6]++;cov_zhuc20ese.s[18]++;res.send({data:notifications.count,success:true,msg:'got '+notifications.count+' new notifications'});});});cov_zhuc20ese.s[19]++;router.post('/getNumberofNewNotificationRequestCourse',function(req,res){cov_zhuc20ese.f[7]++;cov_zhuc20ese.s[20]++;models.Notifications.getNumberofNewNotificationRequestCourse(req.body.userId,notifications=>{cov_zhuc20ese.f[8]++;cov_zhuc20ese.s[21]++;res.send({data:notifications.count,success:true,msg:'got '+notifications.count+' new request Course notifications '});});});cov_zhuc20ese.s[22]++;router.post('/updateNotificationStatus',function(req,res){cov_zhuc20ese.f[9]++;cov_zhuc20ese.s[23]++;models.Notifications.update({status:0},{where:{userId:req.body.userId,status:{$ne:0},id:req.body.id}}).then(function(){cov_zhuc20ese.f[10]++;cov_zhuc20ese.s[24]++;res.send({success:true,msg:"Status updated"});});});cov_zhuc20ese.s[25]++;router.post('/getAllNewNotificationsAndUpdateStatus',function(req,res){cov_zhuc20ese.f[11]++;cov_zhuc20ese.s[26]++;models.Notifications.getAllNewNotifications(req.body.userId,notifications=>{cov_zhuc20ese.f[12]++;cov_zhuc20ese.s[27]++;models.Notifications.update({status:0},{where:{userId:req.body.userId,status:{$ne:0}}}).then(function(){cov_zhuc20ese.f[13]++;cov_zhuc20ese.s[28]++;res.send({data:notifications,msg:"All status updated"});});});});cov_zhuc20ese.s[29]++;router.post('/addNotification',function(req,res){cov_zhuc20ese.f[14]++;cov_zhuc20ese.s[30]++;//let check = await models.Notifications.addNotification(req.body.email, req.body.userId, req.body.title, req.body.content, req.body.time, req.body.reference, req.body.status);
addNoti(req).then(check=>{cov_zhuc20ese.f[15]++;cov_zhuc20ese.s[31]++;if(check===0){cov_zhuc20ese.b[0][0]++;cov_zhuc20ese.s[32]++;console.log('------------------addNotification routes---------------------');cov_zhuc20ese.s[33]++;console.log('-return 0-');cov_zhuc20ese.s[34]++;res.send({result:0,msg:"Dont delete and insert new notification"});}else{cov_zhuc20ese.b[0][1]++;cov_zhuc20ese.s[35]++;console.log('------------------addNotification routes---------------------');cov_zhuc20ese.s[36]++;console.log('-return 1-');cov_zhuc20ese.s[37]++;res.send({result:1,msg:"Delete and insert new notification"});}});// let check = models.Notifications.addNotification(req.body.email, req.body.userId, req.body.title, req.body.content, req.body.time, req.body.reference, req.body.status);
// if (check === 0) {
//     console.log('------------------addNotification routes---------------------');
//     console.log('-return 0-');
//     res.send({
//         result: 0,
//         msg: "Dont delete and insert new notification"
//     });
// }
// else {
//     console.log('------------------addNotification routes---------------------');
//     console.log('-return 1-');
//     res.send({
//         result: 1,
//         msg: "Delete and insert new notification"
//     });
// }
// var p2 = new Promise(function (resolve, reject) {
//     var result = models.Notifications.addNotification(req.body.email, req.body.userId, req.body.title, req.body.content, req.body.time, req.body.reference, req.body.status)
//     if (result != -1) {
//         resolve(result);
//     }
//     else {
//         reject(result);
//     }
// });
// p2.then(function (check) {
//     if (check == 0) {
//         console.log('--------------addNotification routes--------------');
//         console.log('-return 0-');
//         res.send({
//             result: 0,
//             msg: "Dont delete and insert new notification"
//         });
//     }
//     else {
//         console.log('--------------addNotification routes--------------');
//         console.log('-return 1-');
//         res.send({
//             result: 1,
//             msg: "delete and insert new notification"
//         });
//     }
// })
});cov_zhuc20ese.s[38]++;module.exports=router;