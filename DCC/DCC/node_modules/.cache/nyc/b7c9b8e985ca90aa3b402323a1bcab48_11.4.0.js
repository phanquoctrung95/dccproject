var cov_1p34df5otn=function(){var path='D:\\DCC\\DCC\\server\\models\\class.js',hash='f52974cd1dfd6f7c95d76f6ccb6d4982a38fb2cb',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'D:\\DCC\\DCC\\server\\models\\class.js',statementMap:{'0':{start:{line:1,column:18},end:{line:1,column:48}},'1':{start:{line:3,column:0},end:{line:240,column:2}},'2':{start:{line:4,column:16},end:{line:238,column:6}},'3':{start:{line:9,column:16},end:{line:9,column:41}},'4':{start:{line:12,column:28},end:{line:19,column:17}},'5':{start:{line:20,column:16},end:{line:20,column:46}},'6':{start:{line:23,column:16},end:{line:99,column:19}},'7':{start:{line:24,column:34},end:{line:24,column:36}},'8':{start:{line:25,column:20},end:{line:92,column:23}},'9':{start:{line:26,column:42},end:{line:26,column:44}},'10':{start:{line:27,column:47},end:{line:27,column:48}},'11':{start:{line:28,column:47},end:{line:28,column:48}},'12':{start:{line:29,column:45},end:{line:29,column:46}},'13':{start:{line:30,column:43},end:{line:30,column:44}},'14':{start:{line:31,column:44},end:{line:31,column:45}},'15':{start:{line:33,column:49},end:{line:33,column:50}},'16':{start:{line:34,column:49},end:{line:34,column:50}},'17':{start:{line:35,column:47},end:{line:35,column:48}},'18':{start:{line:37,column:24},end:{line:70,column:27}},'19':{start:{line:38,column:28},end:{line:38,column:43}},'20':{start:{line:39,column:28},end:{line:42,column:29}},'21':{start:{line:40,column:32},end:{line:40,column:79}},'22':{start:{line:41,column:32},end:{line:41,column:53}},'23':{start:{line:43,column:28},end:{line:46,column:29}},'24':{start:{line:44,column:32},end:{line:44,column:79}},'25':{start:{line:45,column:32},end:{line:45,column:53}},'26':{start:{line:47,column:28},end:{line:50,column:29}},'27':{start:{line:48,column:32},end:{line:48,column:75}},'28':{start:{line:49,column:32},end:{line:49,column:51}},'29':{start:{line:52,column:28},end:{line:57,column:29}},'30':{start:{line:56,column:32},end:{line:56,column:48}},'31':{start:{line:59,column:42},end:{line:68,column:29}},'32':{start:{line:69,column:28},end:{line:69,column:54}},'33':{start:{line:71,column:54},end:{line:71,column:104}},'34':{start:{line:72,column:54},end:{line:72,column:104}},'35':{start:{line:73,column:52},end:{line:73,column:98}},'36':{start:{line:74,column:42},end:{line:90,column:25}},'37':{start:{line:91,column:24},end:{line:91,column:50}},'38':{start:{line:93,column:35},end:{line:97,column:21}},'39':{start:{line:98,column:20},end:{line:98,column:39}},'40':{start:{line:124,column:28},end:{line:141,column:17}},'41':{start:{line:142,column:16},end:{line:142,column:46}},'42':{start:{line:145,column:28},end:{line:152,column:17}},'43':{start:{line:153,column:16},end:{line:153,column:46}},'44':{start:{line:156,column:16},end:{line:164,column:27}},'45':{start:{line:174,column:16},end:{line:181,column:28}},'46':{start:{line:184,column:16},end:{line:193,column:28}},'47':{start:{line:196,column:16},end:{line:203,column:28}},'48':{start:{line:206,column:16},end:{line:210,column:28}},'49':{start:{line:213,column:16},end:{line:217,column:28}},'50':{start:{line:229,column:16},end:{line:233,column:28}},'51':{start:{line:239,column:4},end:{line:239,column:17}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:3,column:17},end:{line:3,column:18}},loc:{start:{line:3,column:38},end:{line:240,column:1}},line:3},'1':{name:'(anonymous_1)',decl:{start:{line:8,column:25},end:{line:8,column:26}},loc:{start:{line:8,column:39},end:{line:10,column:13}},line:8},'2':{name:'(anonymous_2)',decl:{start:{line:11,column:39},end:{line:11,column:40}},loc:{start:{line:11,column:63},end:{line:21,column:13}},line:11},'3':{name:'(anonymous_3)',decl:{start:{line:22,column:39},end:{line:22,column:40}},loc:{start:{line:22,column:61},end:{line:100,column:13}},line:22},'4':{name:'(anonymous_4)',decl:{start:{line:23,column:42},end:{line:23,column:43}},loc:{start:{line:23,column:61},end:{line:99,column:17}},line:23},'5':{name:'(anonymous_5)',decl:{start:{line:25,column:36},end:{line:25,column:37}},loc:{start:{line:25,column:55},end:{line:92,column:21}},line:25},'6':{name:'(anonymous_6)',decl:{start:{line:37,column:61},end:{line:37,column:62}},loc:{start:{line:37,column:76},end:{line:70,column:25}},line:37},'7':{name:'(anonymous_7)',decl:{start:{line:123,column:37},end:{line:123,column:38}},loc:{start:{line:123,column:51},end:{line:143,column:13}},line:123},'8':{name:'(anonymous_8)',decl:{start:{line:144,column:32},end:{line:144,column:33}},loc:{start:{line:144,column:56},end:{line:154,column:13}},line:144},'9':{name:'(anonymous_9)',decl:{start:{line:155,column:28},end:{line:155,column:29}},loc:{start:{line:155,column:51},end:{line:165,column:13}},line:155},'10':{name:'(anonymous_10)',decl:{start:{line:173,column:17},end:{line:173,column:18}},loc:{start:{line:173,column:59},end:{line:182,column:13}},line:173},'11':{name:'(anonymous_11)',decl:{start:{line:183,column:18},end:{line:183,column:19}},loc:{start:{line:183,column:66},end:{line:194,column:13}},line:183},'12':{name:'(anonymous_12)',decl:{start:{line:195,column:33},end:{line:195,column:34}},loc:{start:{line:195,column:51},end:{line:204,column:13}},line:195},'13':{name:'(anonymous_13)',decl:{start:{line:205,column:29},end:{line:205,column:30}},loc:{start:{line:205,column:47},end:{line:211,column:13}},line:205},'14':{name:'(anonymous_14)',decl:{start:{line:212,column:26},end:{line:212,column:27}},loc:{start:{line:212,column:44},end:{line:218,column:13}},line:212},'15':{name:'(anonymous_15)',decl:{start:{line:228,column:46},end:{line:228,column:47}},loc:{start:{line:228,column:68},end:{line:234,column:13}},line:228}},branchMap:{'0':{loc:{start:{line:39,column:28},end:{line:42,column:29}},type:'if',locations:[{start:{line:39,column:28},end:{line:42,column:29}},{start:{line:39,column:28},end:{line:42,column:29}}],line:39},'1':{loc:{start:{line:43,column:28},end:{line:46,column:29}},type:'if',locations:[{start:{line:43,column:28},end:{line:46,column:29}},{start:{line:43,column:28},end:{line:46,column:29}}],line:43},'2':{loc:{start:{line:47,column:28},end:{line:50,column:29}},type:'if',locations:[{start:{line:47,column:28},end:{line:50,column:29}},{start:{line:47,column:28},end:{line:50,column:29}}],line:47},'3':{loc:{start:{line:52,column:28},end:{line:57,column:29}},type:'if',locations:[{start:{line:52,column:28},end:{line:57,column:29}},{start:{line:52,column:28},end:{line:57,column:29}}],line:52},'4':{loc:{start:{line:52,column:32},end:{line:55,column:71}},type:'binary-expr',locations:[{start:{line:52,column:32},end:{line:52,column:64}},{start:{line:53,column:35},end:{line:53,column:69}},{start:{line:54,column:35},end:{line:54,column:67}},{start:{line:55,column:35},end:{line:55,column:71}}],line:52},'5':{loc:{start:{line:77,column:39},end:{line:77,column:89}},type:'cond-expr',locations:[{start:{line:77,column:62},end:{line:77,column:85}},{start:{line:77,column:88},end:{line:77,column:89}}],line:77},'6':{loc:{start:{line:78,column:41},end:{line:78,column:110}},type:'cond-expr',locations:[{start:{line:78,column:64},end:{line:78,column:93}},{start:{line:78,column:96},end:{line:78,column:110}}],line:78},'7':{loc:{start:{line:81,column:43},end:{line:81,column:130}},type:'cond-expr',locations:[{start:{line:81,column:66},end:{line:81,column:93}},{start:{line:81,column:96},end:{line:81,column:130}}],line:81}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0,'43':0,'44':0,'45':0,'46':0,'47':0,'48':0,'49':0,'50':0,'51':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0,0,0],'5':[0,0],'6':[0,0],'7':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var _classModel=(cov_1p34df5otn.s[0]++,require("./DataObjects/class"));cov_1p34df5otn.s[1]++;module.exports=function(sequelize){cov_1p34df5otn.f[0]++;var Class=(cov_1p34df5otn.s[2]++,sequelize.define('Class',_classModel,{charset:'utf8',collate:'utf8_unicode_ci',classMethods:{getAllClass:function(cb){cov_1p34df5otn.f[1]++;cov_1p34df5otn.s[3]++;Class.findAll().then(cb);},getOpeningClassByCourseID:function(courseId,cb){cov_1p34df5otn.f[2]++;var query=(cov_1p34df5otn.s[4]++,{where:{startTime:{$gt:Date.now()},courseId:courseId}});cov_1p34df5otn.s[5]++;Class.findOne(query).then(cb);},getClassByCourseIDByQuery:function(query,res){cov_1p34df5otn.f[3]++;cov_1p34df5otn.s[6]++;Class.findAll(query).then(function(classes){cov_1p34df5otn.f[4]++;var resData=(cov_1p34df5otn.s[7]++,[]);cov_1p34df5otn.s[8]++;classes.forEach(classByCourseId=>{cov_1p34df5otn.f[5]++;let traineeList=(cov_1p34df5otn.s[9]++,[]);let sumTrainerRating=(cov_1p34df5otn.s[10]++,0);let sumContentRating=(cov_1p34df5otn.s[11]++,0);let sumHappyRating=(cov_1p34df5otn.s[12]++,0);let countTrainee=(cov_1p34df5otn.s[13]++,0);let numOfFeedback=(cov_1p34df5otn.s[14]++,0);//3 biến sau đây là thừa, có thể dùng biến numOfFeedback thay thế
let countContentRating=(cov_1p34df5otn.s[15]++,0);let countTrainerRating=(cov_1p34df5otn.s[16]++,0);let countHappyRating=(cov_1p34df5otn.s[17]++,0);cov_1p34df5otn.s[18]++;classByCourseId.ClassRecords.forEach(classRecord=>{cov_1p34df5otn.f[6]++;cov_1p34df5otn.s[19]++;countTrainee++;cov_1p34df5otn.s[20]++;if(classRecord.trainer_rating!=null){cov_1p34df5otn.b[0][0]++;cov_1p34df5otn.s[21]++;sumTrainerRating+=classRecord.trainer_rating;cov_1p34df5otn.s[22]++;countTrainerRating++;}else{cov_1p34df5otn.b[0][1]++;}cov_1p34df5otn.s[23]++;if(classRecord.content_rating!=null){cov_1p34df5otn.b[1][0]++;cov_1p34df5otn.s[24]++;sumContentRating+=classRecord.content_rating;cov_1p34df5otn.s[25]++;countContentRating++;}else{cov_1p34df5otn.b[1][1]++;}cov_1p34df5otn.s[26]++;if(classRecord.happy_rating!=null){cov_1p34df5otn.b[2][0]++;cov_1p34df5otn.s[27]++;sumHappyRating+=classRecord.happy_rating;cov_1p34df5otn.s[28]++;countHappyRating++;}else{cov_1p34df5otn.b[2][1]++;}cov_1p34df5otn.s[29]++;if((cov_1p34df5otn.b[4][0]++,classRecord.happy_rating!=null)||(cov_1p34df5otn.b[4][1]++,classRecord.content_rating!=null)||(cov_1p34df5otn.b[4][2]++,classRecord.happy_rating!=null)||(cov_1p34df5otn.b[4][3]++,classRecord.improve_comments!=null)){cov_1p34df5otn.b[3][0]++;cov_1p34df5otn.s[30]++;numOfFeedback++;}else{cov_1p34df5otn.b[3][1]++;}let trainee=(cov_1p34df5otn.s[31]++,{traineeName:classRecord.User.username,traineeAvatar:classRecord.User.avatar,traineeMail:classRecord.User.email,bestThing_comment:classRecord.bestThing_comments,trainer_rating:classRecord.trainer_rating,improve_comment:classRecord.improve_comments,content_rating:classRecord.content_rating,happy_rating:classRecord.happy_rating});cov_1p34df5otn.s[32]++;traineeList.push(trainee);});const trainer_ratingAverage=(cov_1p34df5otn.s[33]++,(sumTrainerRating/countTrainerRating).toFixed(2));const content_ratingAverage=(cov_1p34df5otn.s[34]++,(sumContentRating/countContentRating).toFixed(2));const happy_ratingAverage=(cov_1p34df5otn.s[35]++,(sumHappyRating/countHappyRating).toFixed(2));let classDetail=(cov_1p34df5otn.s[36]++,{id:classByCourseId.id,location:classByCourseId.location,trainerId:classByCourseId.User?(cov_1p34df5otn.b[5][0]++,classByCourseId.User.id):(cov_1p34df5otn.b[5][1]++,1),trainerName:classByCourseId.User?(cov_1p34df5otn.b[6][0]++,classByCourseId.User.username):(cov_1p34df5otn.b[6][1]++,"Not Assigned"),startTime:classByCourseId.startTime,endTime:classByCourseId.endTime,trainerAvatar:classByCourseId.User?(cov_1p34df5otn.b[7][0]++,classByCourseId.User.avatar):(cov_1p34df5otn.b[7][1]++,"/img/profiles/defaultProfile.jpg"),traineeList:traineeList,maxAttendant:classByCourseId.maxAttendant,trainer_ratingAverage:trainer_ratingAverage,content_ratingAverage:content_ratingAverage,happy_ratingAverage:happy_ratingAverage,numTrainee:countTrainee,numOfFeedback:numOfFeedback,courseId:classByCourseId.courseId});cov_1p34df5otn.s[37]++;resData.push(classDetail);});// ket thuc forEach
var datasend=(cov_1p34df5otn.s[38]++,{success:true,msg:'send list success',data:resData});cov_1p34df5otn.s[39]++;res.send(datasend);});},// getOpenandIncomClassByCourseID: function (courseId, cb) {
//     var query = {
//         where: {
//             $or: [{
//                     startTime: {
//                         $gt: Date.now()
//                     }
//                 },
//                 {
//                     startTime: {
//                         $lte: Date.now()
//                     },
//                     endTime: { //check endTime
//                         $gt: Date.now()
//                     }
//                 }
//             ],
//             courseId: courseId
//         }
//     };
//     Class.findAll(query).then(cb);
// },
getAllOpenandIncomClass:function(cb){cov_1p34df5otn.f[7]++;var query=(cov_1p34df5otn.s[40]++,{where:{$or:[{startTime:{$gt:Date.now()}},{startTime:{$lte:Date.now()},endTime:{//check endTime
$gt:Date.now()}}]}});cov_1p34df5otn.s[41]++;Class.findAll(query).then(cb);},getClassByCourseID:function(courseId,cb){cov_1p34df5otn.f[8]++;var query=(cov_1p34df5otn.s[42]++,{where:{//startTime: {
//$gt: Date.now()
//},
courseId:courseId}});cov_1p34df5otn.s[43]++;Class.findAll(query).then(cb);},getUserInClass:function(classId,cb){cov_1p34df5otn.f[9]++;cov_1p34df5otn.s[44]++;sequelize.query('SELECT us.*'+' FROM class cl, class_record clr, user us '+'where cl.id = :classId and cl.id = clr.classId and us.id = clr.traineeId',{replacements:{classId:classId},type:sequelize.QueryTypes.SELECT}).then(cb);},// deleteClassByCourseID: function (courseID, cb) {
//     Class.destroy({
//         where: {
//             courseId: courseID
//         }
//     }).then(cb)
// },
add:function(objReq,startTime,endTime,cb){cov_1p34df5otn.f[10]++;cov_1p34df5otn.s[45]++;Class.create({courseId:objReq.body.courseId,location:objReq.body.location,trainerId:objReq.body.trainer.id,startTime:startTime,endTime:endTime}).then(cb);},edit:function(id,location,startTime,endTime,cb){cov_1p34df5otn.f[11]++;cov_1p34df5otn.s[46]++;Class.update({location:location,startTime:startTime,endTime:endTime//trainerId: trainerid,
},{where:{id:id}}).then(cb);},getOpeningClassByID:function(id,cb){cov_1p34df5otn.f[12]++;cov_1p34df5otn.s[47]++;Class.findOne({where:{id:id,startTime:{$gt:Date.now()}}}).then(cb);},deleteClassByID:function(id,cb){cov_1p34df5otn.f[13]++;cov_1p34df5otn.s[48]++;Class.destroy({where:{id:id}}).then(cb);},getClassByID:function(id,cb){cov_1p34df5otn.f[14]++;cov_1p34df5otn.s[49]++;Class.findOne({where:{id:id}}).then(cb);},// Find class by user who learned that class
// getIDClassByUserLearned: function(userID, cb) {
//     sequelize.query('SELECT class_record.* FROM class_record, user WHERE class_record.status = "Learned" AND class_record.traineeId =' + userID, {
//         type: sequelize.QueryTypes.SELECT
//     }).then(cb);
// },
// Get content email: location, start time, end time, name of trainner
getContentEmailFeedBackByClassID:function(classID,cb){cov_1p34df5otn.f[15]++;cov_1p34df5otn.s[50]++;sequelize.query(' select class.location, class.startTime, class.endTime, user.username as trainer'+' from class, user '+' where class.id = '+classID+' and class.trainerId = user.id ',{type:sequelize.QueryTypes.SELECT}).then(cb);}},tableName:'class',timestamps:false}));cov_1p34df5otn.s[51]++;return Class;};