var cov_zhuc20ese=function(){var path='D:\\DCC\\DCC\\server\\routes\\notification\\notification.js',hash='0c40238a61c1a930f639eeff9e61ce6c822a2bb1',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'D:\\DCC\\DCC\\server\\routes\\notification\\notification.js',statementMap:{'0':{start:{line:1,column:13},end:{line:1,column:40}},'1':{start:{line:2,column:13},end:{line:2,column:36}},'2':{start:{line:5,column:18},end:{line:5,column:179}},'3':{start:{line:6,column:4},end:{line:6,column:17}},'4':{start:{line:9,column:0},end:{line:36,column:3}},'5':{start:{line:10,column:4},end:{line:35,column:7}},'6':{start:{line:12,column:8},end:{line:19,column:15}},'7':{start:{line:20,column:8},end:{line:27,column:15}},'8':{start:{line:29,column:8},end:{line:29,column:32}},'9':{start:{line:31,column:8},end:{line:34,column:11}},'10':{start:{line:37,column:0},end:{line:56,column:3}},'11':{start:{line:38,column:4},end:{line:55,column:7}},'12':{start:{line:40,column:8},end:{line:47,column:15}},'13':{start:{line:49,column:8},end:{line:49,column:32}},'14':{start:{line:51,column:8},end:{line:54,column:11}},'15':{start:{line:58,column:0},end:{line:66,column:3}},'16':{start:{line:59,column:4},end:{line:65,column:7}},'17':{start:{line:60,column:8},end:{line:64,column:11}},'18':{start:{line:68,column:0},end:{line:76,column:3}},'19':{start:{line:69,column:4},end:{line:75,column:7}},'20':{start:{line:70,column:8},end:{line:74,column:11}},'21':{start:{line:78,column:0},end:{line:95,column:3}},'22':{start:{line:79,column:4},end:{line:94,column:11}},'23':{start:{line:90,column:12},end:{line:93,column:15}},'24':{start:{line:97,column:0},end:{line:115,column:3}},'25':{start:{line:98,column:4},end:{line:114,column:7}},'26':{start:{line:99,column:8},end:{line:113,column:15}},'27':{start:{line:109,column:16},end:{line:112,column:19}},'28':{start:{line:116,column:0},end:{line:186,column:2}},'29':{start:{line:118,column:4},end:{line:135,column:7}},'30':{start:{line:119,column:8},end:{line:134,column:9}},'31':{start:{line:120,column:12},end:{line:120,column:89}},'32':{start:{line:121,column:12},end:{line:121,column:38}},'33':{start:{line:122,column:12},end:{line:125,column:15}},'34':{start:{line:128,column:12},end:{line:128,column:89}},'35':{start:{line:129,column:12},end:{line:129,column:38}},'36':{start:{line:130,column:12},end:{line:133,column:15}},'37':{start:{line:187,column:0},end:{line:187,column:24}}},fnMap:{'0':{name:'addNoti',decl:{start:{line:4,column:15},end:{line:4,column:22}},loc:{start:{line:4,column:28},end:{line:7,column:1}},line:4},'1':{name:'(anonymous_1)',decl:{start:{line:9,column:33},end:{line:9,column:34}},loc:{start:{line:9,column:53},end:{line:36,column:1}},line:9},'2':{name:'(anonymous_2)',decl:{start:{line:10,column:85},end:{line:10,column:86}},loc:{start:{line:10,column:102},end:{line:35,column:5}},line:10},'3':{name:'(anonymous_3)',decl:{start:{line:37,column:46},end:{line:37,column:47}},loc:{start:{line:37,column:66},end:{line:56,column:1}},line:37},'4':{name:'(anonymous_4)',decl:{start:{line:38,column:94},end:{line:38,column:95}},loc:{start:{line:38,column:111},end:{line:55,column:5}},line:38},'5':{name:'(anonymous_5)',decl:{start:{line:58,column:43},end:{line:58,column:44}},loc:{start:{line:58,column:63},end:{line:66,column:1}},line:58},'6':{name:'(anonymous_6)',decl:{start:{line:59,column:69},end:{line:59,column:70}},loc:{start:{line:59,column:86},end:{line:65,column:5}},line:59},'7':{name:'(anonymous_7)',decl:{start:{line:68,column:56},end:{line:68,column:57}},loc:{start:{line:68,column:76},end:{line:76,column:1}},line:68},'8':{name:'(anonymous_8)',decl:{start:{line:69,column:82},end:{line:69,column:83}},loc:{start:{line:69,column:99},end:{line:75,column:5}},line:69},'9':{name:'(anonymous_9)',decl:{start:{line:78,column:41},end:{line:78,column:42}},loc:{start:{line:78,column:61},end:{line:95,column:1}},line:78},'10':{name:'(anonymous_10)',decl:{start:{line:89,column:16},end:{line:89,column:17}},loc:{start:{line:89,column:28},end:{line:94,column:9}},line:89},'11':{name:'(anonymous_11)',decl:{start:{line:97,column:54},end:{line:97,column:55}},loc:{start:{line:97,column:74},end:{line:115,column:1}},line:97},'12':{name:'(anonymous_12)',decl:{start:{line:98,column:65},end:{line:98,column:66}},loc:{start:{line:98,column:82},end:{line:114,column:5}},line:98},'13':{name:'(anonymous_13)',decl:{start:{line:108,column:20},end:{line:108,column:21}},loc:{start:{line:108,column:32},end:{line:113,column:13}},line:108},'14':{name:'(anonymous_14)',decl:{start:{line:116,column:31},end:{line:116,column:32}},loc:{start:{line:116,column:51},end:{line:186,column:1}},line:116},'15':{name:'(anonymous_15)',decl:{start:{line:118,column:22},end:{line:118,column:23}},loc:{start:{line:118,column:33},end:{line:135,column:5}},line:118}},branchMap:{'0':{loc:{start:{line:119,column:8},end:{line:134,column:9}},type:'if',locations:[{start:{line:119,column:8},end:{line:134,column:9}},{start:{line:119,column:8},end:{line:134,column:9}}],line:119}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0},b:{'0':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var router=(cov_zhuc20ese.s[0]++,require('express').Router());var models=(cov_zhuc20ese.s[1]++,require('../../models'));async function addNoti(req){cov_zhuc20ese.f[0]++;const check=(cov_zhuc20ese.s[2]++,await models.Notifications.addNotification(req.body.email,req.body.userId,req.body.title,req.body.content,req.body.time,req.body.reference,req.body.status));cov_zhuc20ese.s[3]++;return check;}cov_zhuc20ese.s[4]++;router.post('/getNotifications',function(req,res){cov_zhuc20ese.f[1]++;cov_zhuc20ese.s[5]++;models.Notifications.getAllNotificationByUserId(req.body.userId,req.body.index,notifications=>{cov_zhuc20ese.f[2]++;cov_zhuc20ese.s[6]++;//
models.Notifications.update({status:2},{where:{userId:req.body.userId,status:1}});cov_zhuc20ese.s[7]++;models.Notifications.update({status:4},{where:{userId:req.body.userId,status:3}});//
cov_zhuc20ese.s[8]++;notifications.reverse();//
cov_zhuc20ese.s[9]++;res.send({data:notifications,msg:'got '+notifications.length+' notifications'});});});cov_zhuc20ese.s[10]++;router.post('/getNotificationsRequestCourse',function(req,res){cov_zhuc20ese.f[3]++;cov_zhuc20ese.s[11]++;models.Notifications.getAllNewNotificationsRequestCourse(req.body.userId,req.body.index,notifications=>{cov_zhuc20ese.f[4]++;cov_zhuc20ese.s[12]++;//
models.Notifications.update({status:4},{where:{userId:req.body.userId,status:3}});//
cov_zhuc20ese.s[13]++;notifications.reverse();//
cov_zhuc20ese.s[14]++;res.send({data:notifications,msg:'got '+notifications.length+' request course notifications'});});});cov_zhuc20ese.s[15]++;router.post('/getNumberofNewNotification',function(req,res){cov_zhuc20ese.f[5]++;cov_zhuc20ese.s[16]++;models.Notifications.getNumberofNewNotification(req.body.userId,notifications=>{cov_zhuc20ese.f[6]++;cov_zhuc20ese.s[17]++;res.send({data:notifications.count,success:true,msg:'got '+notifications.count+' new notifications'});});});cov_zhuc20ese.s[18]++;router.post('/getNumberofNewNotificationRequestCourse',function(req,res){cov_zhuc20ese.f[7]++;cov_zhuc20ese.s[19]++;models.Notifications.getNumberofNewNotificationRequestCourse(req.body.userId,notifications=>{cov_zhuc20ese.f[8]++;cov_zhuc20ese.s[20]++;res.send({data:notifications.count,success:true,msg:'got '+notifications.count+' new request Course notifications '});});});cov_zhuc20ese.s[21]++;router.post('/updateNotificationStatus',function(req,res){cov_zhuc20ese.f[9]++;cov_zhuc20ese.s[22]++;models.Notifications.update({status:0},{where:{userId:req.body.userId,status:{$ne:0},id:req.body.id}}).then(function(){cov_zhuc20ese.f[10]++;cov_zhuc20ese.s[23]++;res.send({success:true,msg:"Status updated"});});});cov_zhuc20ese.s[24]++;router.post('/getAllNewNotificationsAndUpdateStatus',function(req,res){cov_zhuc20ese.f[11]++;cov_zhuc20ese.s[25]++;models.Notifications.getAllNewNotifications(req.body.userId,notifications=>{cov_zhuc20ese.f[12]++;cov_zhuc20ese.s[26]++;models.Notifications.update({status:0},{where:{userId:req.body.userId,status:{$ne:0}}}).then(function(){cov_zhuc20ese.f[13]++;cov_zhuc20ese.s[27]++;res.send({data:notifications,msg:"All status updated"});});});});cov_zhuc20ese.s[28]++;router.post('/addNotification',function(req,res){cov_zhuc20ese.f[14]++;cov_zhuc20ese.s[29]++;//let check = await models.Notifications.addNotification(req.body.email, req.body.userId, req.body.title, req.body.content, req.body.time, req.body.reference, req.body.status);
addNoti(req).then(check=>{cov_zhuc20ese.f[15]++;cov_zhuc20ese.s[30]++;if(check===0){cov_zhuc20ese.b[0][0]++;cov_zhuc20ese.s[31]++;console.log('------------------addNotification routes---------------------');cov_zhuc20ese.s[32]++;console.log('-return 0-');cov_zhuc20ese.s[33]++;res.send({result:0,msg:"Dont delete and insert new notification"});}else{cov_zhuc20ese.b[0][1]++;cov_zhuc20ese.s[34]++;console.log('------------------addNotification routes---------------------');cov_zhuc20ese.s[35]++;console.log('-return 1-');cov_zhuc20ese.s[36]++;res.send({result:1,msg:"Delete and insert new notification"});}});// let check = models.Notifications.addNotification(req.body.email, req.body.userId, req.body.title, req.body.content, req.body.time, req.body.reference, req.body.status);
// if (check === 0) {
//     console.log('------------------addNotification routes---------------------');
//     console.log('-return 0-');
//     res.send({
//         result: 0,
//         msg: "Dont delete and insert new notification"
//     });
// }
// else {
//     console.log('------------------addNotification routes---------------------');
//     console.log('-return 1-');
//     res.send({
//         result: 1,
//         msg: "Delete and insert new notification"
//     });
// }
// var p2 = new Promise(function (resolve, reject) {
//     var result = models.Notifications.addNotification(req.body.email, req.body.userId, req.body.title, req.body.content, req.body.time, req.body.reference, req.body.status)
//     if (result != -1) {
//         resolve(result);
//     }
//     else {
//         reject(result);
//     }
// });
// p2.then(function (check) {
//     if (check == 0) {
//         console.log('--------------addNotification routes--------------');
//         console.log('-return 0-');
//         res.send({
//             result: 0,
//             msg: "Dont delete and insert new notification"
//         });
//     }
//     else {
//         console.log('--------------addNotification routes--------------');
//         console.log('-return 1-');
//         res.send({
//             result: 1,
//             msg: "delete and insert new notification"
//         });
//     }
// })
});cov_zhuc20ese.s[37]++;module.exports=router;