var cov_1c7x4m2bb3=function(){var path='D:\\DCC\\DCC\\server\\middleware\\authMiddleware.js',hash='a3180b6f2686a0041fbcbc68a3e02c737c0b096e',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'D:\\DCC\\DCC\\server\\middleware\\authMiddleware.js',statementMap:{'0':{start:{line:1,column:13},end:{line:1,column:33}},'1':{start:{line:2,column:10},end:{line:2,column:44}},'2':{start:{line:3,column:21},end:{line:58,column:1}},'3':{start:{line:5,column:8},end:{line:5,column:52}},'4':{start:{line:6,column:8},end:{line:14,column:9}},'5':{start:{line:7,column:12},end:{line:7,column:26}},'6':{start:{line:9,column:12},end:{line:9,column:56}},'7':{start:{line:10,column:12},end:{line:13,column:15}},'8':{start:{line:17,column:8},end:{line:17,column:44}},'9':{start:{line:18,column:8},end:{line:28,column:10}},'10':{start:{line:19,column:12},end:{line:27,column:13}},'11':{start:{line:20,column:16},end:{line:20,column:30}},'12':{start:{line:22,column:16},end:{line:22,column:75}},'13':{start:{line:23,column:16},end:{line:26,column:19}},'14':{start:{line:31,column:8},end:{line:31,column:46}},'15':{start:{line:32,column:8},end:{line:42,column:10}},'16':{start:{line:33,column:12},end:{line:41,column:13}},'17':{start:{line:34,column:16},end:{line:34,column:30}},'18':{start:{line:36,column:16},end:{line:36,column:77}},'19':{start:{line:37,column:16},end:{line:40,column:19}},'20':{start:{line:45,column:8},end:{line:45,column:46}},'21':{start:{line:46,column:8},end:{line:56,column:11}},'22':{start:{line:47,column:12},end:{line:55,column:13}},'23':{start:{line:48,column:16},end:{line:48,column:30}},'24':{start:{line:50,column:16},end:{line:50,column:77}},'25':{start:{line:51,column:16},end:{line:54,column:19}},'26':{start:{line:60,column:0},end:{line:60,column:32}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:4,column:25},end:{line:4,column:26}},loc:{start:{line:4,column:50},end:{line:15,column:5}},line:4},'1':{name:'(anonymous_1)',decl:{start:{line:16,column:26},end:{line:16,column:27}},loc:{start:{line:16,column:51},end:{line:29,column:5}},line:16},'2':{name:'(anonymous_2)',decl:{start:{line:18,column:71},end:{line:18,column:72}},loc:{start:{line:18,column:79},end:{line:28,column:9}},line:18},'3':{name:'(anonymous_3)',decl:{start:{line:30,column:28},end:{line:30,column:29}},loc:{start:{line:30,column:53},end:{line:43,column:5}},line:30},'4':{name:'(anonymous_4)',decl:{start:{line:32,column:71},end:{line:32,column:72}},loc:{start:{line:32,column:79},end:{line:42,column:9}},line:32},'5':{name:'(anonymous_5)',decl:{start:{line:44,column:28},end:{line:44,column:29}},loc:{start:{line:44,column:53},end:{line:57,column:5}},line:44},'6':{name:'(anonymous_6)',decl:{start:{line:46,column:71},end:{line:46,column:72}},loc:{start:{line:46,column:79},end:{line:56,column:9}},line:46}},branchMap:{'0':{loc:{start:{line:6,column:8},end:{line:14,column:9}},type:'if',locations:[{start:{line:6,column:8},end:{line:14,column:9}},{start:{line:6,column:8},end:{line:14,column:9}}],line:6},'1':{loc:{start:{line:19,column:12},end:{line:27,column:13}},type:'if',locations:[{start:{line:19,column:12},end:{line:27,column:13}},{start:{line:19,column:12},end:{line:27,column:13}}],line:19},'2':{loc:{start:{line:19,column:16},end:{line:19,column:53}},type:'binary-expr',locations:[{start:{line:19,column:16},end:{line:19,column:37}},{start:{line:19,column:41},end:{line:19,column:53}}],line:19},'3':{loc:{start:{line:33,column:12},end:{line:41,column:13}},type:'if',locations:[{start:{line:33,column:12},end:{line:41,column:13}},{start:{line:33,column:12},end:{line:41,column:13}}],line:33},'4':{loc:{start:{line:33,column:16},end:{line:33,column:55}},type:'binary-expr',locations:[{start:{line:33,column:16},end:{line:33,column:37}},{start:{line:33,column:41},end:{line:33,column:55}}],line:33},'5':{loc:{start:{line:47,column:12},end:{line:55,column:13}},type:'if',locations:[{start:{line:47,column:12},end:{line:55,column:13}},{start:{line:47,column:12},end:{line:55,column:13}}],line:47},'6':{loc:{start:{line:47,column:16},end:{line:47,column:55}},type:'binary-expr',locations:[{start:{line:47,column:16},end:{line:47,column:37}},{start:{line:47,column:41},end:{line:47,column:55}}],line:47}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0],'5':[0,0],'6':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var models=(cov_1c7x4m2bb3.s[0]++,require('../models'));var log=(cov_1c7x4m2bb3.s[1]++,require('../config/config')["log"]);var authMiddleware=(cov_1c7x4m2bb3.s[2]++,{ensureAuthenticated:function(req,res,next){cov_1c7x4m2bb3.f[0]++;cov_1c7x4m2bb3.s[3]++;log.info('Ensure authenticated middleware');cov_1c7x4m2bb3.s[4]++;if(req.isAuthenticated()){cov_1c7x4m2bb3.b[0][0]++;cov_1c7x4m2bb3.s[5]++;return next();}else{cov_1c7x4m2bb3.b[0][1]++;cov_1c7x4m2bb3.s[6]++;log.info('Receive unauthenticated request');cov_1c7x4m2bb3.s[7]++;res.send({success:false,msg:"You need to login first"});}},ensureAdminPrivilege:function(req,res,next){cov_1c7x4m2bb3.f[1]++;cov_1c7x4m2bb3.s[8]++;log.info('Ensure admin middleware');cov_1c7x4m2bb3.s[9]++;models.User.findOne({where:{email:req.user.email}}).then(user=>{cov_1c7x4m2bb3.f[2]++;cov_1c7x4m2bb3.s[10]++;if((cov_1c7x4m2bb3.b[2][0]++,req.isAuthenticated())&&(cov_1c7x4m2bb3.b[2][1]++,user.isAdmin)){cov_1c7x4m2bb3.b[1][0]++;cov_1c7x4m2bb3.s[11]++;return next();}else{cov_1c7x4m2bb3.b[1][1]++;cov_1c7x4m2bb3.s[12]++;log.info('Receive under-privilege request to admin route');cov_1c7x4m2bb3.s[13]++;res.send({success:false,msg:"You need Admin privilege to access this route"});}});},ensureTrainerPrivilege:function(req,res,next){cov_1c7x4m2bb3.f[3]++;cov_1c7x4m2bb3.s[14]++;log.info('Ensure trainer middleware');cov_1c7x4m2bb3.s[15]++;models.User.findOne({where:{email:req.user.email}}).then(user=>{cov_1c7x4m2bb3.f[4]++;cov_1c7x4m2bb3.s[16]++;if((cov_1c7x4m2bb3.b[4][0]++,req.isAuthenticated())&&(cov_1c7x4m2bb3.b[4][1]++,user.isTrainer)){cov_1c7x4m2bb3.b[3][0]++;cov_1c7x4m2bb3.s[17]++;return next();}else{cov_1c7x4m2bb3.b[3][1]++;cov_1c7x4m2bb3.s[18]++;log.info('Receive under-privilege request to trainer route');cov_1c7x4m2bb3.s[19]++;res.send({success:false,msg:"You need Trainer privilege to access this route"});}});},ensureTraineePrivilege:function(req,res,next){cov_1c7x4m2bb3.f[5]++;cov_1c7x4m2bb3.s[20]++;log.info('Ensure trainee middleware');cov_1c7x4m2bb3.s[21]++;models.User.findOne({where:{email:req.user.email}}).then(user=>{cov_1c7x4m2bb3.f[6]++;cov_1c7x4m2bb3.s[22]++;if((cov_1c7x4m2bb3.b[6][0]++,req.isAuthenticated())&&(cov_1c7x4m2bb3.b[6][1]++,user.isTrainee)){cov_1c7x4m2bb3.b[5][0]++;cov_1c7x4m2bb3.s[23]++;return next();}else{cov_1c7x4m2bb3.b[5][1]++;cov_1c7x4m2bb3.s[24]++;log.info('Receive under-privilege request to trainee route');cov_1c7x4m2bb3.s[25]++;res.send({success:false,msg:"You need Trainee privilege to access this route"});}});}});cov_1c7x4m2bb3.s[26]++;module.exports=authMiddleware;