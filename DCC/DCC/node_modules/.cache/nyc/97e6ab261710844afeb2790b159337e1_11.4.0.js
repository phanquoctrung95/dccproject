var cov_1v2g8sjoos=function(){var path='D:\\DCC\\DCC\\server\\routes\\common\\course.js',hash='e48bed1bdbf150748c61d6fc83edb87192180c2f',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'D:\\DCC\\DCC\\server\\routes\\common\\course.js',statementMap:{'0':{start:{line:1,column:13},end:{line:1,column:40}},'1':{start:{line:2,column:13},end:{line:2,column:36}},'2':{start:{line:3,column:10},end:{line:3,column:47}},'3':{start:{line:5,column:0},end:{line:12,column:3}},'4':{start:{line:6,column:4},end:{line:11,column:7}},'5':{start:{line:7,column:8},end:{line:10,column:11}},'6':{start:{line:13,column:0},end:{line:21,column:3}},'7':{start:{line:14,column:4},end:{line:20,column:7}},'8':{start:{line:15,column:8},end:{line:19,column:11}},'9':{start:{line:22,column:0},end:{line:42,column:3}},'10':{start:{line:23,column:4},end:{line:41,column:5}},'11':{start:{line:32,column:27},end:{line:32,column:29}},'12':{start:{line:33,column:12},end:{line:35,column:13}},'13':{start:{line:34,column:16},end:{line:34,column:55}},'14':{start:{line:36,column:12},end:{line:39,column:15}},'15':{start:{line:43,column:0},end:{line:132,column:3}},'16':{start:{line:44,column:4},end:{line:44,column:52}},'17':{start:{line:45,column:16},end:{line:55,column:5}},'18':{start:{line:56,column:4},end:{line:131,column:7}},'19':{start:{line:57,column:22},end:{line:57,column:24}},'20':{start:{line:58,column:33},end:{line:58,column:34}},'21':{start:{line:59,column:31},end:{line:59,column:32}},'22':{start:{line:60,column:8},end:{line:124,column:11}},'23':{start:{line:61,column:30},end:{line:61,column:32}},'24':{start:{line:62,column:35},end:{line:62,column:36}},'25':{start:{line:63,column:35},end:{line:63,column:36}},'26':{start:{line:64,column:33},end:{line:64,column:34}},'27':{start:{line:65,column:37},end:{line:65,column:38}},'28':{start:{line:66,column:31},end:{line:66,column:32}},'29':{start:{line:67,column:32},end:{line:67,column:33}},'30':{start:{line:69,column:12},end:{line:102,column:15}},'31':{start:{line:70,column:16},end:{line:70,column:31}},'32':{start:{line:71,column:16},end:{line:74,column:17}},'33':{start:{line:72,column:20},end:{line:72,column:67}},'34':{start:{line:73,column:20},end:{line:73,column:41}},'35':{start:{line:75,column:16},end:{line:78,column:17}},'36':{start:{line:76,column:20},end:{line:76,column:67}},'37':{start:{line:77,column:20},end:{line:77,column:41}},'38':{start:{line:79,column:16},end:{line:82,column:17}},'39':{start:{line:80,column:20},end:{line:80,column:63}},'40':{start:{line:81,column:20},end:{line:81,column:39}},'41':{start:{line:84,column:16},end:{line:89,column:17}},'42':{start:{line:88,column:24},end:{line:88,column:40}},'43':{start:{line:91,column:30},end:{line:100,column:17}},'44':{start:{line:101,column:16},end:{line:101,column:42}},'45':{start:{line:103,column:42},end:{line:103,column:90}},'46':{start:{line:104,column:42},end:{line:104,column:90}},'47':{start:{line:105,column:40},end:{line:105,column:82}},'48':{start:{line:106,column:30},end:{line:122,column:13}},'49':{start:{line:123,column:12},end:{line:123,column:38}},'50':{start:{line:125,column:23},end:{line:129,column:9}},'51':{start:{line:130,column:8},end:{line:130,column:27}},'52':{start:{line:135,column:0},end:{line:144,column:3}},'53':{start:{line:136,column:4},end:{line:136,column:79}},'54':{start:{line:137,column:4},end:{line:143,column:6}},'55':{start:{line:138,column:8},end:{line:142,column:10}},'56':{start:{line:147,column:0},end:{line:156,column:3}},'57':{start:{line:148,column:4},end:{line:148,column:85}},'58':{start:{line:149,column:4},end:{line:155,column:6}},'59':{start:{line:150,column:8},end:{line:154,column:10}},'60':{start:{line:159,column:0},end:{line:168,column:3}},'61':{start:{line:160,column:4},end:{line:160,column:63}},'62':{start:{line:161,column:4},end:{line:167,column:6}},'63':{start:{line:162,column:8},end:{line:166,column:10}},'64':{start:{line:170,column:0},end:{line:170,column:24}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:5,column:32},end:{line:5,column:33}},loc:{start:{line:5,column:52},end:{line:12,column:1}},line:5},'1':{name:'(anonymous_1)',decl:{start:{line:6,column:45},end:{line:6,column:46}},loc:{start:{line:6,column:63},end:{line:11,column:5}},line:6},'2':{name:'(anonymous_2)',decl:{start:{line:13,column:29},end:{line:13,column:30}},loc:{start:{line:13,column:48},end:{line:21,column:1}},line:13},'3':{name:'(anonymous_3)',decl:{start:{line:14,column:33},end:{line:14,column:34}},loc:{start:{line:14,column:47},end:{line:20,column:5}},line:14},'4':{name:'(anonymous_4)',decl:{start:{line:22,column:39},end:{line:22,column:40}},loc:{start:{line:22,column:59},end:{line:42,column:1}},line:22},'5':{name:'(anonymous_5)',decl:{start:{line:31,column:8},end:{line:31,column:9}},loc:{start:{line:31,column:24},end:{line:40,column:9}},line:31},'6':{name:'(anonymous_6)',decl:{start:{line:43,column:35},end:{line:43,column:36}},loc:{start:{line:43,column:55},end:{line:132,column:1}},line:43},'7':{name:'(anonymous_7)',decl:{start:{line:56,column:37},end:{line:56,column:38}},loc:{start:{line:56,column:56},end:{line:131,column:5}},line:56},'8':{name:'(anonymous_8)',decl:{start:{line:60,column:24},end:{line:60,column:25}},loc:{start:{line:60,column:43},end:{line:124,column:9}},line:60},'9':{name:'(anonymous_9)',decl:{start:{line:69,column:49},end:{line:69,column:50}},loc:{start:{line:69,column:64},end:{line:102,column:13}},line:69},'10':{name:'(anonymous_10)',decl:{start:{line:135,column:50},end:{line:135,column:51}},loc:{start:{line:135,column:69},end:{line:144,column:1}},line:135},'11':{name:'(anonymous_11)',decl:{start:{line:137,column:71},end:{line:137,column:72}},loc:{start:{line:137,column:85},end:{line:143,column:5}},line:137},'12':{name:'(anonymous_12)',decl:{start:{line:147,column:53},end:{line:147,column:54}},loc:{start:{line:147,column:72},end:{line:156,column:1}},line:147},'13':{name:'(anonymous_13)',decl:{start:{line:149,column:77},end:{line:149,column:78}},loc:{start:{line:149,column:91},end:{line:155,column:5}},line:149},'14':{name:'(anonymous_14)',decl:{start:{line:159,column:33},end:{line:159,column:34}},loc:{start:{line:159,column:52},end:{line:168,column:1}},line:159},'15':{name:'(anonymous_15)',decl:{start:{line:161,column:55},end:{line:161,column:56}},loc:{start:{line:161,column:69},end:{line:167,column:5}},line:161}},branchMap:{'0':{loc:{start:{line:71,column:16},end:{line:74,column:17}},type:'if',locations:[{start:{line:71,column:16},end:{line:74,column:17}},{start:{line:71,column:16},end:{line:74,column:17}}],line:71},'1':{loc:{start:{line:75,column:16},end:{line:78,column:17}},type:'if',locations:[{start:{line:75,column:16},end:{line:78,column:17}},{start:{line:75,column:16},end:{line:78,column:17}}],line:75},'2':{loc:{start:{line:79,column:16},end:{line:82,column:17}},type:'if',locations:[{start:{line:79,column:16},end:{line:82,column:17}},{start:{line:79,column:16},end:{line:82,column:17}}],line:79},'3':{loc:{start:{line:84,column:16},end:{line:89,column:17}},type:'if',locations:[{start:{line:84,column:16},end:{line:89,column:17}},{start:{line:84,column:16},end:{line:89,column:17}}],line:84},'4':{loc:{start:{line:84,column:20},end:{line:87,column:59}},type:'binary-expr',locations:[{start:{line:84,column:20},end:{line:84,column:52}},{start:{line:85,column:23},end:{line:85,column:57}},{start:{line:86,column:23},end:{line:86,column:55}},{start:{line:87,column:23},end:{line:87,column:59}}],line:84},'5':{loc:{start:{line:109,column:27},end:{line:109,column:77}},type:'cond-expr',locations:[{start:{line:109,column:50},end:{line:109,column:73}},{start:{line:109,column:76},end:{line:109,column:77}}],line:109},'6':{loc:{start:{line:110,column:29},end:{line:110,column:98}},type:'cond-expr',locations:[{start:{line:110,column:52},end:{line:110,column:81}},{start:{line:110,column:84},end:{line:110,column:98}}],line:110},'7':{loc:{start:{line:113,column:31},end:{line:113,column:118}},type:'cond-expr',locations:[{start:{line:113,column:54},end:{line:113,column:81}},{start:{line:113,column:84},end:{line:113,column:118}}],line:113}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0,'43':0,'44':0,'45':0,'46':0,'47':0,'48':0,'49':0,'50':0,'51':0,'52':0,'53':0,'54':0,'55':0,'56':0,'57':0,'58':0,'59':0,'60':0,'61':0,'62':0,'63':0,'64':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0,0,0],'5':[0,0],'6':[0,0],'7':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var router=(cov_1v2g8sjoos.s[0]++,require('express').Router());var models=(cov_1v2g8sjoos.s[1]++,require('../../models'));var log=(cov_1v2g8sjoos.s[2]++,require('../../config/config')["log"]);cov_1v2g8sjoos.s[3]++;router.post('/getCourseDetail',function(req,res){cov_1v2g8sjoos.f[0]++;cov_1v2g8sjoos.s[4]++;models.Course.getByID(req.body.courseId,function(course){cov_1v2g8sjoos.f[1]++;cov_1v2g8sjoos.s[5]++;res.send({success:true,data:course});});});cov_1v2g8sjoos.s[6]++;router.post('/getAllCourse',function(req,res){cov_1v2g8sjoos.f[2]++;cov_1v2g8sjoos.s[7]++;models.Course.findAll().then(function(rs){cov_1v2g8sjoos.f[3]++;cov_1v2g8sjoos.s[8]++;res.send({success:true,msg:"send course detail list",data:rs});});});cov_1v2g8sjoos.s[9]++;router.post('/getRequesterByCourseID',function(req,res){cov_1v2g8sjoos.f[4]++;cov_1v2g8sjoos.s[10]++;models.RequestOpening.findAll({include:[{model:models.User}],where:{courseId:req.body.courseId}}).then(function(data){cov_1v2g8sjoos.f[5]++;var userList=(cov_1v2g8sjoos.s[11]++,[]);cov_1v2g8sjoos.s[12]++;for(let i=0;i<data.length;i++){cov_1v2g8sjoos.s[13]++;userList.push(data[i].dataValues.User);}cov_1v2g8sjoos.s[14]++;res.send({success:true,data:userList});});});cov_1v2g8sjoos.s[15]++;router.post('/getClassByCourseID',function(req,res){cov_1v2g8sjoos.f[6]++;cov_1v2g8sjoos.s[16]++;log.info('/common/course/getClassByCourseID: ');var query=(cov_1v2g8sjoos.s[17]++,{include:[models.User,{model:models.ClassRecord,include:[models.User]}],where:{courseId:req.body.courseId}});cov_1v2g8sjoos.s[18]++;models.Class.findAll(query).then(function(classes){cov_1v2g8sjoos.f[7]++;var resData=(cov_1v2g8sjoos.s[19]++,[]);let countTrainerRating=(cov_1v2g8sjoos.s[20]++,0);let countHappyRating=(cov_1v2g8sjoos.s[21]++,0);cov_1v2g8sjoos.s[22]++;classes.forEach(classByCourseId=>{cov_1v2g8sjoos.f[8]++;let traineeList=(cov_1v2g8sjoos.s[23]++,[]);let sumTrainerRating=(cov_1v2g8sjoos.s[24]++,0);let sumContentRating=(cov_1v2g8sjoos.s[25]++,0);let sumHappyRating=(cov_1v2g8sjoos.s[26]++,0);let countContentRating=(cov_1v2g8sjoos.s[27]++,0);let countTrainee=(cov_1v2g8sjoos.s[28]++,0);let numOfFeedback=(cov_1v2g8sjoos.s[29]++,0);cov_1v2g8sjoos.s[30]++;classByCourseId.ClassRecords.forEach(classRecord=>{cov_1v2g8sjoos.f[9]++;cov_1v2g8sjoos.s[31]++;countTrainee++;cov_1v2g8sjoos.s[32]++;if(classRecord.trainer_rating!=null){cov_1v2g8sjoos.b[0][0]++;cov_1v2g8sjoos.s[33]++;sumTrainerRating+=classRecord.trainer_rating;cov_1v2g8sjoos.s[34]++;countTrainerRating++;}else{cov_1v2g8sjoos.b[0][1]++;}cov_1v2g8sjoos.s[35]++;if(classRecord.content_rating!=null){cov_1v2g8sjoos.b[1][0]++;cov_1v2g8sjoos.s[36]++;sumContentRating+=classRecord.content_rating;cov_1v2g8sjoos.s[37]++;countContentRating++;}else{cov_1v2g8sjoos.b[1][1]++;}cov_1v2g8sjoos.s[38]++;if(classRecord.happy_rating!=null){cov_1v2g8sjoos.b[2][0]++;cov_1v2g8sjoos.s[39]++;sumHappyRating+=classRecord.happy_rating;cov_1v2g8sjoos.s[40]++;countHappyRating++;}else{cov_1v2g8sjoos.b[2][1]++;}cov_1v2g8sjoos.s[41]++;if((cov_1v2g8sjoos.b[4][0]++,classRecord.happy_rating!=null)||(cov_1v2g8sjoos.b[4][1]++,classRecord.content_rating!=null)||(cov_1v2g8sjoos.b[4][2]++,classRecord.happy_rating!=null)||(cov_1v2g8sjoos.b[4][3]++,classRecord.improve_comments!=null)){cov_1v2g8sjoos.b[3][0]++;cov_1v2g8sjoos.s[42]++;numOfFeedback++;}else{cov_1v2g8sjoos.b[3][1]++;}let trainee=(cov_1v2g8sjoos.s[43]++,{traineeName:classRecord.User.username,traineeAvatar:classRecord.User.avatar,traineeMail:classRecord.User.email,bestThing_comment:classRecord.bestThing_comments,trainer_rating:classRecord.trainer_rating,improve_comment:classRecord.improve_comments,content_rating:classRecord.content_rating,happy_rating:classRecord.happy_rating});cov_1v2g8sjoos.s[44]++;traineeList.push(trainee);});const trainer_ratingAverage=(cov_1v2g8sjoos.s[45]++,Math.ceil(sumTrainerRating/countTrainerRating));const content_ratingAverage=(cov_1v2g8sjoos.s[46]++,Math.ceil(sumContentRating/countContentRating));const happy_ratingAverage=(cov_1v2g8sjoos.s[47]++,Math.ceil(sumHappyRating/countHappyRating));let classDetail=(cov_1v2g8sjoos.s[48]++,{id:classByCourseId.id,location:classByCourseId.location,trainerId:classByCourseId.User?(cov_1v2g8sjoos.b[5][0]++,classByCourseId.User.id):(cov_1v2g8sjoos.b[5][1]++,1),trainerName:classByCourseId.User?(cov_1v2g8sjoos.b[6][0]++,classByCourseId.User.username):(cov_1v2g8sjoos.b[6][1]++,"Not Assigned"),startTime:classByCourseId.startTime,endTime:classByCourseId.endTime,trainerAvatar:classByCourseId.User?(cov_1v2g8sjoos.b[7][0]++,classByCourseId.User.avatar):(cov_1v2g8sjoos.b[7][1]++,"/img/profiles/defaultProfile.jpg"),traineeList:traineeList,maxAttendant:classByCourseId.maxAttendant,trainer_ratingAverage:trainer_ratingAverage,content_ratingAverage:content_ratingAverage,happy_ratingAverage:happy_ratingAverage,numTrainee:countTrainee,numOfFeedback:numOfFeedback,courseId:classByCourseId.courseId});cov_1v2g8sjoos.s[49]++;resData.push(classDetail);});// ket thuc forEach
var datasend=(cov_1v2g8sjoos.s[50]++,{success:true,msg:'send list success',data:resData});cov_1v2g8sjoos.s[51]++;res.send(datasend);});});// Get all courses of a user who don't have feedback by user id
cov_1v2g8sjoos.s[52]++;router.post('getCourseOfUserDontFeedbackByUserID',function(req,res){cov_1v2g8sjoos.f[10]++;cov_1v2g8sjoos.s[53]++;console.log("getCourseOfUserDontFeedbackByUserID API: "+req.body.userID);cov_1v2g8sjoos.s[54]++;models.Course.getCourseOfUserDontFeedbackByUserID(req.body.userID,function(rs){cov_1v2g8sjoos.f[11]++;cov_1v2g8sjoos.s[55]++;res.send({success:true,msg:"Get all courses of a user who don't have feedback by user id",data:rs});});});// Get all courses of a user who don't have feedback by user id
cov_1v2g8sjoos.s[56]++;router.post('getCourseOfUserDontFeedbackByUserEmail',function(req,res){cov_1v2g8sjoos.f[12]++;cov_1v2g8sjoos.s[57]++;console.log("getCourseOfUserDontFeedbackByUserEmail API: "+req.body.userEmail);cov_1v2g8sjoos.s[58]++;models.Course.getCourseOfUserDontFeedbackByUserEmail(req.body.userEmail,function(rs){cov_1v2g8sjoos.f[13]++;cov_1v2g8sjoos.s[59]++;res.send({success:true,msg:"Get all courses of a user who don't have feedback by user email ",data:rs});});});// Get course by class id 
cov_1v2g8sjoos.s[60]++;router.post('getCourseByClassID',function(req,res){cov_1v2g8sjoos.f[14]++;cov_1v2g8sjoos.s[61]++;console.log("getCourseByClassID API: "+req.body.classID);cov_1v2g8sjoos.s[62]++;models.Course.getCourseByClassID(req.body.classID,function(rs){cov_1v2g8sjoos.f[15]++;cov_1v2g8sjoos.s[63]++;res.send({success:true,msg:"Get all infomation about course by class id  ",data:rs});});});cov_1v2g8sjoos.s[64]++;module.exports=router;